try{window||(window={})}catch(e){window={},exports.console=console}var persistence=window&&window.persistence?window.persistence:{};persistence.store||(persistence.store={}),persistence.store.memory={},persistence.store.memory.config=function(a,b){function g(b){var c=d[b._entityName];return c||(c=new a.LocalQueryCollection),c=c.clone(),c._filter=b._filter,c._prefetchFields=b._prefetchFields,c._orderColumns=b._orderColumns,c._limit=b._limit,c._skip=b._skip,c._reverse=b._reverse,c}var c=a.argspec;b=b||"persistenceData";var d={};a.getAllObjects=function(){return d};var e=a.add;a.add=function(b){if(!this.trackedObjects[b.id]){e.call(this,b);var c=b._type;d[c]||(d[c]=new a.LocalQueryCollection,d[c]._session=a),d[c].add(b)}return this};var f=a.remove;a.remove=function(a){f.call(this,a);var b=a._type;d[b].remove(a)},a.schemaSync=function(b,d,e){var f=c.getArgs(arguments,[{name:"tx",optional:!0,check:a.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:c.isCallback(),defaultValue:function(){}},{name:"emulate",optional:!0,check:c.hasType("boolean")}]);f.callback()},a.flush=function(b,d){var e=c.getArgs(arguments,[{name:"tx",optional:!0,check:a.isTransaction},{name:"callback",optional:!0,check:c.isCallback(),defaultValue:function(){}}]),f=a.flushHooks,g=this;a.asyncForEach(f,function(a,c){a(g,b,c)},function(){var b=a.trackedObjects;for(var c in b)b.hasOwnProperty(c)&&(a.objectsToRemove.hasOwnProperty(c)?delete b[c]:b[c]._dirtyProperties={});e.callback()})},a.transaction=function(a){setTimeout(function(){a({executeSql:function(){}})},0)},a.loadFromLocalStorage=function(a){var c=window.localStorage.getItem(b);c?this.loadFromJson(c,a):a&&a()},a.saveToLocalStorage=function(a){this.dumpToJson(function(c){window.localStorage.setItem(b,c),a&&a()})},a.reset=function(b,e){var f=c.getArgs(arguments,[{name:"tx",optional:!0,check:a.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:c.isCallback(),defaultValue:function(){}}]);b=f.tx,e=f.callback,d={},this.clean(),e()},a.close=function(){},a.DbQueryCollection.prototype.list=function(b,d){var e=c.getArgs(arguments,[{name:"tx",optional:!0,check:a.isTransaction,defaultValue:null},{name:"callback",optional:!1,check:c.isCallback()}]);b=e.tx,d=e.callback;var f=g(this);f.list(null,d)},a.DbQueryCollection.prototype.destroyAll=function(b,d){var e=c.getArgs(arguments,[{name:"tx",optional:!0,check:a.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:c.isCallback(),defaultValue:function(){}}]);b=e.tx,d=e.callback;var f=g(this);f.destroyAll(null,d)},a.DbQueryCollection.prototype.count=function(b,d){var e=c.getArgs(arguments,[{name:"tx",optional:!0,check:a.isTransaction,defaultValue:null},{name:"callback",optional:!1,check:c.isCallback()}]);b=e.tx,d=e.callback;var f=g(this);f.count(null,d)},a.ManyToManyDbQueryCollection=function(b,c){this.init(b,c,a.ManyToManyDbQueryCollection),this._items=[]},a.ManyToManyDbQueryCollection.prototype=new a.LocalQueryCollection,a.ManyToManyDbQueryCollection.prototype.initManyToMany=function(a,b){this._obj=a,this._coll=b},a.ManyToManyDbQueryCollection.prototype.add=function(b,c){a.LocalQueryCollection.prototype.add.call(this,b);if(!c){var d=a.getMeta(this._obj._type),e=d.hasMany[this._coll].inverseProperty;a.get(b,e).add(this._obj,!0)}},a.ManyToManyDbQueryCollection.prototype.remove=function(b,c){a.LocalQueryCollection.prototype.remove.call(this,b);if(!c){var d=a.getMeta(this._obj._type),e=d.hasMany[this._coll].inverseProperty;a.get(b,e).remove(this._obj,!0)}}};try{exports.config=persistence.store.memory.config,exports.getSession=function(){return persistence}}catch(e){}
