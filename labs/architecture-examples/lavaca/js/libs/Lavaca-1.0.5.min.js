/*
Lavaca 1.0.5
Copyright (c) 2012 Mutual Mobile

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

Contains components from or inspired by:

Simple Reset
(c) 2011 Eric Meyer
Released to public domain

jQuery v1.7.1
(c) 2011, John Resig
Dual licensed under the MIT or GPL Version 2 licenses.

Sizzle.js
(c) 2011, The Dojo Foundation
Released under the MIT, BSD, and GPL licenses.

Backbone.js 0.9.1 and Underscore.js 1.3.1
(c) 2012, Jeremy Ashkenas, DocumentCloud Inc
Released under the MIT license.

LinkedIn Fork of Dust.js 1.1
(c) 2010, Aleksander Williams
Released under the MIT license.

Zepto.js 0.8.0
(c) 2011 Thomas Fuchs
Released under the MIT license

ChildBrowser
(c) 2012 Jesse MacFadyen, Nitobi
Released under the MIT license

lz77.js
(c) 2009 Olle Törnström
Released under the MIT license
*/
(function(b){String.prototype.trim===b&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});Array.prototype.reduce===b&&(Array.prototype.reduce=function(h){if(this===void 0||this===null)throw new TypeError;var j=Object(this),g=j.length>>>0,f=0,c;if(typeof h!="function")throw new TypeError;if(g==0&&arguments.length==1)throw new TypeError;if(arguments.length>=2)c=arguments[1];else{do{if(f in j){c=j[f++];break}if(++f>=g)throw new TypeError;}while(1)}for(;f<g;){f in j&&
(c=h.call(b,c,j[f],f,j));f++}return c})})();
var Zepto=function(){function b(a){return"[object Function]"==K.call(a)}function h(a){return a instanceof Object}function j(a){var e,d;if("[object Object]"!==K.call(a))return!1;d=b(a.constructor)&&a.constructor.prototype;if(!d||!hasOwnProperty.call(d,"isPrototypeOf"))return!1;for(e in a);return e===q||hasOwnProperty.call(a,e)}function g(a){return a instanceof Array}function f(a){return"number"==typeof a.length}function c(a){return a.filter(function(a){return a!==q&&null!==a})}function a(a){return a.replace(/::/g,
"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function d(a){return a in t?t[a]:t[a]=RegExp("(^|\\s)"+a+"(\\s|$)")}function e(a,e){return e===q?n(a):n(a).filter(e)}function l(a,e,d,f){return b(e)?e.call(a,d,f):e}function k(a,e,d){var f=a%2?e:e.parentNode;f?f.insertBefore(d,!a?e.nextSibling:1==a?f.firstChild:2==a?e:null):n(d).remove()}function o(a,e){e(a);for(var d in a.childNodes)o(a.childNodes[d],e)}var q,p,n,r,s=[],y=s.slice,w=
window.document,v={},t={},A=w.defaultView.getComputedStyle,u={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},L=/^\s*<(\w+|!)[^>]*>/,J=[1,3,8,9,11],Q=w.createElement("table"),C=w.createElement("tr"),D={tr:w.createElement("tbody"),tbody:Q,thead:Q,tfoot:Q,td:C,th:C,"*":w.createElement("div")},E=/complete|loaded|interactive/,B=/^\.([\w-]+)$/,N=/^#([\w-]+)$/,H=/^[\w-]+$/,K={}.toString,x={},F,M,I=w.createElement("div");x.matches=function(a,e){if(!a||1!==a.nodeType)return!1;
var d=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(d)return d.call(a,e);var f;f=a.parentNode;(d=!f)&&(f=I).appendChild(a);f=~x.qsa(f,e).indexOf(a);d&&I.removeChild(a);return f};F=function(a){return a.replace(/-+(.)?/g,function(a,e){return e?e.toUpperCase():""})};M=function(a){return a.filter(function(e,d){return a.indexOf(e)==d})};x.fragment=function(a,e){e===q&&(e=L.test(a)&&RegExp.$1);e in D||(e="*");var d=D[e];d.innerHTML=""+a;return n.each(y.call(d.childNodes),
function(){d.removeChild(this)})};x.Z=function(a,e){a=a||[];a.__proto__=arguments.callee.prototype;a.selector=e||"";return a};x.isZ=function(a){return a instanceof x.Z};x.init=function(a,e){if(a){if(b(a))return n(w).ready(a);if(x.isZ(a))return a;var d;if(g(a))d=c(a);else if(j(a))d=[n.extend({},a)],a=null;else if(0<=J.indexOf(a.nodeType)||a===window)d=[a],a=null;else if(L.test(a))d=x.fragment(a.trim(),RegExp.$1),a=null;else{if(e!==q)return n(e).find(a);d=x.qsa(w,a)}return x.Z(d,a)}return x.Z()};n=
function(a,e){return x.init(a,e)};n.extend=function(a){y.call(arguments,1).forEach(function(e){for(p in e)e[p]!==q&&(a[p]=e[p])});return a};x.qsa=function(a,e){var d;return a===w&&N.test(e)?(d=a.getElementById(RegExp.$1))?[d]:s:1!==a.nodeType&&9!==a.nodeType?s:y.call(B.test(e)?a.getElementsByClassName(RegExp.$1):H.test(e)?a.getElementsByTagName(e):a.querySelectorAll(e))};n.isFunction=b;n.isObject=h;n.isArray=g;n.isPlainObject=j;n.inArray=function(a,e,d){return s.indexOf.call(e,a,d)};n.trim=function(a){return a.trim()};
n.uuid=0;n.map=function(a,e){var d,c=[],l;if(f(a))for(l=0;l<a.length;l++)d=e(a[l],l),null!=d&&c.push(d);else for(l in a)d=e(a[l],l),null!=d&&c.push(d);return 0<c.length?[].concat.apply([],c):c};n.each=function(a,e){var d;if(f(a))for(d=0;d<a.length&&!1!==e.call(a[d],d,a[d]);d++);else for(d in a)if(!1===e.call(a[d],d,a[d]))break;return a};n.fn={forEach:s.forEach,reduce:s.reduce,push:s.push,indexOf:s.indexOf,concat:s.concat,map:function(a){return n.map(this,function(e,d){return a.call(e,d,e)})},slice:function(){return n(y.apply(this,
arguments))},ready:function(a){E.test(w.readyState)?a(n):w.addEventListener("DOMContentLoaded",function(){a(n)},!1);return this},get:function(a){return a===q?y.call(this):this[a]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){this.forEach(function(e,d){a.call(e,d,e)});return this},filter:function(a){return n([].filter.call(this,function(e){return x.matches(e,
a)}))},add:function(a,e){return n(M(this.concat(n(a,e))))},is:function(a){return 0<this.length&&x.matches(this[0],a)},not:function(a){var e=[];if(b(a)&&a.call!==q)this.each(function(d){a.call(this,d)||e.push(this)});else{var d="string"==typeof a?this.filter(a):f(a)&&b(a.item)?y.call(a):n(a);this.forEach(function(a){0>d.indexOf(a)&&e.push(a)})}return n(e)},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!h(a)?a:n(a)},last:function(){var a=this[this.length-
1];return a&&!h(a)?a:n(a)},find:function(a){var e;e=1==this.length?x.qsa(this[0],a):this.map(function(){return x.qsa(this,a)});return n(e)},closest:function(a,e){for(var d=this[0];d&&!x.matches(d,a);)d=d!==e&&d!==w&&d.parentNode;return n(d)},parents:function(a){for(var d=[],f=this;0<f.length;)f=n.map(f,function(a){if((a=a.parentNode)&&a!==w&&0>d.indexOf(a))return d.push(a),a});return e(d,a)},parent:function(a){return e(M(this.pluck("parentNode")),a)},children:function(a){return e(this.map(function(){return y.call(this.children)}),
a)},siblings:function(a){return e(this.map(function(a,e){return y.call(e.parentNode.children).filter(function(a){return a!==e})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return this.map(function(){return this[a]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null);if("none"==A(this,"").getPropertyValue("display")){var a=this.style,e=this.nodeName,d,f;v[e]||(d=w.createElement(e),w.body.appendChild(d),f=
A(d,"").getPropertyValue("display"),d.parentNode.removeChild(d),"none"==f&&(f="block"),v[e]=f);a.display=v[e]}})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){return this.each(function(){n(this).wrapAll(n(a)[0].cloneNode(!1))})},wrapAll:function(a){this[0]&&(n(this[0]).before(a=n(a)),a.append(this));return this},unwrap:function(){this.parent().each(function(){n(this).replaceWith(n(this).children())});return this},clone:function(){return n(this.map(function(){return this.cloneNode(!0)}))},
hide:function(){return this.css("display","none")},toggle:function(a){return(a===q?"none"==this.css("display"):a)?this.show():this.hide()},prev:function(){return n(this.pluck("previousElementSibling"))},next:function(){return n(this.pluck("nextElementSibling"))},html:function(a){return a===q?0<this.length?this[0].innerHTML:null:this.each(function(e){var d=this.innerHTML;n(this).empty().append(l(this,a,e,d))})},text:function(a){return a===q?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=
a})},attr:function(a,e){var d;return"string"==typeof a&&e===q?0==this.length||1!==this[0].nodeType?q:"value"==a&&"INPUT"==this[0].nodeName?this.val():!(d=this[0].getAttribute(a))&&a in this[0]?this[0][a]:d:this.each(function(d){if(1===this.nodeType)if(h(a))for(p in a)this.setAttribute(p,a[p]);else this.setAttribute(a,l(this,e,d,this.getAttribute(a)))})},removeAttr:function(a){return this.each(function(){1===this.nodeType&&this.removeAttribute(a)})},prop:function(a,e){return e===q?this[0]?this[0][a]:
q:this.each(function(d){this[a]=l(this,e,d,this[a])})},data:function(e,d){var f=this.attr("data-"+a(e),d);return null!==f?f:q},val:function(a){return a===q?0<this.length?this[0].value:q:this.each(function(e){this.value=l(this,a,e,this.value)})},offset:function(){if(0==this.length)return null;var a=this[0].getBoundingClientRect();return{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:a.width,height:a.height}},css:function(e,d){if(d===q&&"string"==typeof e)return 0==this.length?q:
this[0].style[F(e)]||A(this[0],"").getPropertyValue(e);var f="";for(p in e)"string"==typeof e[p]&&""==e[p]?this.each(function(){this.style.removeProperty(a(p))}):f+=a(p)+":"+("number"==typeof e[p]&&!u[a(p)]?e[p]+"px":e[p])+";";"string"==typeof e&&(""==d?this.each(function(){this.style.removeProperty(a(e))}):f=a(e)+":"+("number"==typeof d&&!u[a(e)]?d+"px":d));return this.each(function(){this.style.cssText+=";"+f})},index:function(a){return a?this.indexOf(n(a)[0]):this.parent().children().indexOf(this[0])},
hasClass:function(a){return 1>this.length?!1:d(a).test(this[0].className)},addClass:function(a){return this.each(function(e){r=[];var d=this.className;l(this,a,e,d).split(/\s+/g).forEach(function(a){n(this).hasClass(a)||r.push(a)},this);r.length&&(this.className+=(d?" ":"")+r.join(" "))})},removeClass:function(a){return this.each(function(e){if(a===q)return this.className="";r=this.className;l(this,a,e,r).split(/\s+/g).forEach(function(a){r=r.replace(d(a)," ")});this.className=r.trim()})},toggleClass:function(a,
e){return this.each(function(d){d=l(this,a,d,this.className);(e===q?!n(this).hasClass(d):e)?n(this).addClass(d):n(this).removeClass(d)})}};["width","height"].forEach(function(a){n.fn[a]=function(e){var d,f=a.replace(/./,function(a){return a[0].toUpperCase()});return e===q?this[0]==window?window["inner"+f]:this[0]==w?w.documentElement["offset"+f]:(d=this.offset())&&d[a]:this.each(function(d){var f=n(this);f.css(a,l(this,e,d,f[a]()))})}});["after","prepend","before","append"].forEach(function(a,e){n.fn[a]=
function(){var a=n.map(arguments,function(a){return h(a)?a:x.fragment(a)});if(1>a.length)return this;var d=this.length,f=1<d,c=2>e;return this.each(function(l,b){for(var g=0;g<a.length;g++){var h=a[c?a.length-g-1:g];o(h,function(a){null!=a.nodeName&&("SCRIPT"===a.nodeName.toUpperCase()&&(!a.type||"text/javascript"===a.type))&&window.eval.call(window,a.innerHTML)});f&&l<d-1&&(h=h.cloneNode(!0));k(e,b,h)}})};n.fn[e%2?a+"To":"insert"+(e?"Before":"After")]=function(e){n(e)[a](this);return this}});x.Z.prototype=
n.fn;x.camelize=F;x.uniq=M;n.zepto=x;return n}();window.Zepto=Zepto;"$"in window||(window.$=Zepto);
(function(b){function h(a){return a._zid||(a._zid=k++)}function j(a,e,d,f){e=g(e);if(e.ns)var c=RegExp("(?:^| )"+e.ns.replace(" "," .* ?")+"(?: |$)");return(l[h(a)]||[]).filter(function(a){return a&&(!e.e||a.e==e.e)&&(!e.ns||c.test(a.ns))&&(!d||h(a.fn)===h(d))&&(!f||a.sel==f)})}function g(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function f(a,e,d){b.isObject(a)?b.each(a,d):a.split(/\s/).forEach(function(a){d(a,e)})}function c(a,e,d,c,k,o){var o=!!o,j=h(a),u=l[j]||(l[j]=
[]);f(e,d,function(e,d){var f=k&&k(d,e),l=f||d,h=function(e){var d=l.apply(a,[e].concat(e.data));!1===d&&e.preventDefault();return d},f=b.extend(g(e),{fn:d,proxy:h,sel:c,del:f,i:u.length});u.push(f);a.addEventListener(f.e,h,o)})}function a(a,e,d,c){var b=h(a);f(e||"",d,function(e,d){j(a,e,d,c).forEach(function(e){delete l[b][e.i];a.removeEventListener(e.e,e.proxy,!1)})})}function d(a){var e=b.extend({originalEvent:a},a);b.each(n,function(d,f){e[d]=function(){this[f]=q;return a[d].apply(a,arguments)};
e[f]=p});return e}function e(a){if(!("defaultPrevented"in a)){a.defaultPrevented=!1;var e=a.preventDefault;a.preventDefault=function(){this.defaultPrevented=!0;e.call(this)}}}var l={},k=1,o={};o.click=o.mousedown=o.mouseup=o.mousemove="MouseEvents";b.event={add:c,remove:a};b.proxy=function(a,e){if(b.isFunction(a)){var d=function(){return a.apply(e,arguments)};d._zid=h(a);return d}if("string"==typeof e)return b.proxy(a[e],a);throw new TypeError("expected function");};b.fn.bind=function(a,e){return this.each(function(){c(this,
a,e)})};b.fn.unbind=function(e,d){return this.each(function(){a(this,e,d)})};b.fn.one=function(e,d){return this.each(function(f,l){c(this,e,d,null,function(e,d){return function(){var f=e.apply(l,arguments);a(l,d,e);return f}})})};var q=function(){return!0},p=function(){return!1},n={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};b.fn.delegate=function(a,e,f){var l=!1;if("blur"==e||"focus"==e)b.iswebkit?e="blur"==
e?"focusout":"focus"==e?"focusin":e:l=!0;return this.each(function(k,g){c(g,e,f,a,function(e){return function(f){var c,l=b(f.target).closest(a,g).get(0);if(l)return c=b.extend(d(f),{currentTarget:l,liveFired:g}),e.apply(l,[c].concat([].slice.call(arguments,1)))}},l)})};b.fn.undelegate=function(e,d,f){return this.each(function(){a(this,d,f,e)})};b.fn.live=function(a,e){b(document.body).delegate(this.selector,a,e);return this};b.fn.die=function(a,e){b(document.body).undelegate(this.selector,a,e);return this};
b.fn.on=function(a,e,d){return void 0==e||b.isFunction(e)?this.bind(a,e):this.delegate(e,a,d)};b.fn.off=function(a,e,d){return void 0==e||b.isFunction(e)?this.unbind(a,e):this.undelegate(e,a,d)};b.fn.trigger=function(a,d){"string"==typeof a&&(a=b.Event(a));e(a);a.data=d;return this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(a)})};b.fn.triggerHandler=function(a,e){var f,c;this.each(function(l,k){f=d("string"==typeof a?b.Event(a):a);f.data=e;f.target=k;b.each(j(k,a.type||a),function(a,
e){c=e.proxy(f);if(f.isImmediatePropagationStopped())return!1})});return c};"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout change select keydown keypress keyup error".split(" ").forEach(function(a){b.fn[a]=function(e){return this.bind(a,e)}});["focus","blur"].forEach(function(a){b.fn[a]=function(e){if(e)this.bind(a,e);else if(this.length)try{this.get(0)[a]()}catch(d){}return this}});b.Event=function(a,e){var d=document.createEvent(o[a]||"Events"),
f=!0;if(e)for(var c in e)"bubbles"==c?f=!!e[c]:d[c]=e[c];d.initEvent(a,f,!0,null,null,null,null,null,null,null,null,null,null,null,null);return d}})(Zepto);
(function(b){function h(b){var g=this.os={},f=this.browser={},c=b.match(/WebKit\/([\d.]+)/),a=b.match(/(Android)\s+([\d.]+)/),d=b.match(/(iPad).*OS\s([\d_]+)/),e=!d&&b.match(/(iPhone\sOS)\s([\d_]+)/),l=b.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),k=l&&b.match(/TouchPad/),h=b.match(/Kindle\/([\d.]+)/),q=b.match(/Silk\/([\d._]+)/),p=b.match(/(BlackBerry).*Version\/([\d.]+)/);if(f.webkit=!!c)f.version=c[1];a&&(g.android=!0,g.version=a[2]);e&&(g.ios=g.iphone=!0,g.version=e[2].replace(/_/g,"."));d&&(g.ios=g.ipad=
!0,g.version=d[2].replace(/_/g,"."));l&&(g.webos=!0,g.version=l[2]);k&&(g.touchpad=!0);p&&(g.blackberry=!0,g.version=p[2]);h&&(g.kindle=!0,g.version=h[1]);q&&(f.silk=!0,f.version=q[1]);!q&&(g.android&&b.match(/Kindle Fire/))&&(f.silk=!0)}h.call(b,navigator.userAgent);b.__detect=h})(Zepto);
(function(b,h){var j="",g,f=window.document.createElement("div"),c=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,a={};b.each({Webkit:"webkit",Moz:"",O:"o",ms:"MS"},function(a,e){if(f.style[a+"TransitionProperty"]!==h)return j="-"+a.toLowerCase()+"-",g=e,!1});a[j+"transition-property"]=a[j+"transition-duration"]=a[j+"transition-timing-function"]=a[j+"animation-name"]=a[j+"animation-duration"]="";b.fx={off:g===h&&f.style.transitionProperty===h,cssPrefix:j,transitionEnd:g?
g+"TransitionEnd":"transitionend",animationEnd:g?g+"AnimationEnd":"animationend"};b.fn.animate=function(a,e,f,c){b.isObject(e)&&(f=e.easing,c=e.complete,e=e.duration);e&&(e/=1E3);return this.anim(a,e,f,c)};b.fn.anim=function(d,e,f,k){var g,q={},p,n=this,r,s=b.fx.transitionEnd;e===h&&(e=0.4);b.fx.off&&(e=0);if("string"==typeof d)q[j+"animation-name"]=d,q[j+"animation-duration"]=e+"s",s=b.fx.animationEnd;else{for(p in d)c.test(p)?(g||(g=[]),g.push(p+"("+d[p]+")")):q[p]=d[p];g&&(q[j+"transform"]=g.join(" "));
!b.fx.off&&"object"===typeof d&&(q[j+"transition-property"]=Object.keys(d).join(", "),q[j+"transition-duration"]=e+"s",q[j+"transition-timing-function"]=f||"linear")}r=function(e){if("undefined"!==typeof e){if(e.target!==e.currentTarget)return;b(e.target).unbind(s,arguments.callee)}b(this).css(a);k&&k.call(this)};0<e&&this.bind(s,r);setTimeout(function(){n.css(q);0>=e&&setTimeout(function(){n.each(function(){r.call(this)})},0)},0);return this};f=null})(Zepto);
(function(b){function h(a,e,d,f){if(a.global)return a=e||p,d=b.Event(d),b(a).trigger(d,f),!d.defaultPrevented}function j(a){a.global&&0===b.active++&&h(a,null,"ajaxStart")}function g(a,e){var d=e.context;if(!1===e.beforeSend.call(d,a,e)||!1===h(e,d,"ajaxBeforeSend",[a,e]))return!1;h(e,d,"ajaxSend",[a,e])}function f(e,d,f){var c=f.context;f.success.call(c,e,"success",d);h(f,c,"ajaxSuccess",[d,f,e]);a("success",d,f)}function c(e,d,f,c){var l=c.context;c.error.call(l,f,d,e);h(c,l,"ajaxError",[f,c,e]);
a(d,f,c)}function a(a,e,d){var f=d.context;d.complete.call(f,e,a);h(d,f,"ajaxComplete",[e,d]);d.global&&!--b.active&&h(d,null,"ajaxStop")}function d(){}function e(a){return a&&(a==t?"html":a==v?"json":y.test(a)?"script":w.test(a)&&"xml")||"text"}function l(a){q(a.data)&&(a.data=b.param(a.data));if(a.data&&(!a.type||"GET"==a.type.toUpperCase()))a.url=(a.url+"&"+a.data).replace(/[&?]{1,2}/,"?")}function k(a,e,d,f){var c=b.isArray(e);b.each(e,function(e,l){f&&(e=d?f:f+"["+(c?"":e)+"]");!f&&c?a.add(l.name,
l.value):(d?b.isArray(l):q(l))?k(a,l,d,e):a.add(e,l)})}var o=0,q=b.isObject,p=window.document,n,r,s=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,y=/^(?:text|application)\/javascript/i,w=/^(?:text|application)\/xml/i,v="application/json",t="text/html",A=/^\s*$/;b.active=0;b.ajaxJSONP=function(e){var c="jsonp"+ ++o,k=p.createElement("script"),g={abort:function(){b(k).remove();c in window&&(window[c]=d);a("abort",g,e)}},h;e.error&&(k.onerror=function(){g.abort();e.error()});window[c]=function(a){clearTimeout(h);
b(k).remove();delete window[c];f(a,g,e)};l(e);k.src=e.url.replace(/=\?/,"="+c);b("head").append(k);0<e.timeout&&(h=setTimeout(function(){g.abort();a("timeout",g,e)},e.timeout));return g};b.ajaxSettings={type:"GET",beforeSend:d,success:d,error:d,complete:d,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:v,xml:"application/xml, text/xml",html:t,text:"text/plain"},crossDomain:!1,timeout:0};b.ajax=function(a){var k=
b.extend({},a||{});for(n in b.ajaxSettings)void 0===k[n]&&(k[n]=b.ajaxSettings[n]);j(k);k.crossDomain||(k.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(k.url)&&RegExp.$2!=window.location.host);var h=k.dataType,a=/=\?/.test(k.url);if("jsonp"==h||a)return a||(k.url=(k.url+"&callback=?").replace(/[&?]{1,2}/,"?")),b.ajaxJSONP(k);k.url||(k.url=window.location.toString());l(k);var a=k.accepts[h],o={},q=/^([\w-]+:)\/\//.test(k.url)?RegExp.$1:window.location.protocol,u=b.ajaxSettings.xhr(),p;k.crossDomain||
(o["X-Requested-With"]="XMLHttpRequest");a&&(o.Accept=a,-1<a.indexOf(",")&&(a=a.split(",",2)[0]),u.overrideMimeType&&u.overrideMimeType(a));if(k.contentType||k.data&&"GET"!=k.type.toUpperCase())o["Content-Type"]=k.contentType||"application/x-www-form-urlencoded";k.headers=b.extend(o,k.headers||{});u.onreadystatechange=function(){if(u.readyState==4){clearTimeout(p);var a,d=false;if(u.status>=200&&u.status<300||u.status==304||u.status==0&&q=="file:"){h=h||e(u.getResponseHeader("content-type"));a=u.responseText;
try{h=="script"?(0,eval)(a):h=="xml"?a=u.responseXML:h=="json"&&(a=A.test(a)?null:JSON.parse(a))}catch(l){d=l}d?c(d,"parsererror",u,k):f(a,u,k)}else c(null,"error",u,k)}};u.open(k.type,k.url,"async"in k?k.async:!0);for(r in k.headers)u.setRequestHeader(r,k.headers[r]);if(!1===g(u,k))return u.abort(),!1;0<k.timeout&&(p=setTimeout(function(){u.onreadystatechange=d;u.abort();c(null,"timeout",u,k)},k.timeout));u.send(k.data?k.data:null);return u};b.get=function(a,e){return b.ajax({url:a,success:e})};
b.post=function(a,e,d,f){b.isFunction(e)&&(f=f||d,d=e,e=null);return b.ajax({type:"POST",url:a,data:e,success:d,dataType:f})};b.getJSON=function(a,e){return b.ajax({url:a,success:e,dataType:"json"})};b.fn.load=function(a,e){if(!this.length)return this;var d=this,f=a.split(/\s/),c;1<f.length&&(a=f[0],c=f[1]);b.get(a,function(a){d.html(c?b(p.createElement("div")).html(a.replace(s,"")).find(c).html():a);e&&e.call(d)});return this};var u=encodeURIComponent;b.param=function(a,e){var d=[];d.add=function(a,
e){this.push(u(a)+"="+u(e))};k(d,a,e);return d.join("&").replace("%20","+")}})(Zepto);
(function(b){b.fn.serializeArray=function(){var h=[],j;b(Array.prototype.slice.call(this.get(0).elements)).each(function(){j=b(this);var g=j.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&(!this.disabled&&"submit"!=g&&"reset"!=g&&"button"!=g&&("radio"!=g&&"checkbox"!=g||this.checked))&&h.push({name:j.attr("name"),value:j.val()})});return h};b.fn.serialize=function(){var b=[];this.serializeArray().forEach(function(j){b.push(encodeURIComponent(j.name)+"="+encodeURIComponent(j.value))});return b.join("&")};
b.fn.submit=function(h){h?this.bind("submit",h):this.length&&(h=b.Event("submit"),this.eq(0).trigger(h),h.defaultPrevented||this.get(0).submit());return this}})(Zepto);
(function(b){function h(a,d,e,f){var c=Math.abs(a-d),b=Math.abs(e-f);return c>=b?0<a-d?"Left":"Right":0<e-f?"Up":"Down"}function j(){c=null;g.last&&(g.el.trigger("longTap"),g={})}var g={},f,c;b(document).ready(function(){var a,d;b(document.body).bind("touchstart",function(e){a=Date.now();d=a-(g.last||a);g.el=b("tagName"in e.touches[0].target?e.touches[0].target:e.touches[0].target.parentNode);f&&clearTimeout(f);g.x1=e.touches[0].pageX;g.y1=e.touches[0].pageY;0<d&&250>=d&&(g.isDoubleTap=!0);g.last=
a;c=setTimeout(j,750)}).bind("touchmove",function(a){c&&clearTimeout(c);c=null;g.x2=a.touches[0].pageX;g.y2=a.touches[0].pageY}).bind("touchend",function(){c&&clearTimeout(c);c=null;g.isDoubleTap?(g.el.trigger("doubleTap"),g={}):g.x2&&30<Math.abs(g.x1-g.x2)||g.y2&&30<Math.abs(g.y1-g.y2)?(g.el.trigger("swipe")&&g.el.trigger("swipe"+h(g.x1,g.x2,g.y1,g.y2)),g={}):"last"in g&&(g.el.trigger("tap"),f=setTimeout(function(){f=null;g.el.trigger("singleTap");g={}},250))}).bind("touchcancel",function(){f&&clearTimeout(f);
c&&clearTimeout(c);c=f=null;g={}})});"swipe swipeLeft swipeRight swipeUp swipeDown doubleTap tap singleTap longTap".split(" ").forEach(function(a){b.fn[a]=function(d){return this.bind(a,d)}})})(Zepto);var dust={};function getGlobal(){return function(){return this.dust}.call(null)}
(function(b){function h(a,e,d){this.stack=a;this.global=e;this.blocks=d}function j(a,e,d,f){this.tail=e;this.isObject=!b.isArray(a)&&a&&"object"===typeof a;this.head=a;this.index=d;this.of=f}function g(a){this.head=new c(this);this.callback=a;this.out=""}function f(){this.head=new c(this)}function c(a,e,d){this.root=a;this.next=e;this.data="";this.flushable=!1;this.taps=d}function a(a,e){this.head=a;this.tail=e}b.cache={};b.register=function(a,e){a&&(b.cache[a]=e)};b.render=function(a,e,d){d=(new g(d)).head;
b.load(a,d,h.wrap(e)).end()};b.stream=function(a,e){var d=new f;b.nextTick(function(){b.load(a,d.head,h.wrap(e)).end()});return d};b.renderSource=function(a,e,d){return b.compileFn(a)(e,d)};b.compileFn=function(a,e){var d=b.loadSource(b.compile(a,e));return function(a,e){var c=e?new g(e):new f;b.nextTick(function(){d(c.head,h.wrap(a)).end()});return c}};b.load=function(a,e,d){var f=b.cache[a];return f?f(e,d):b.onLoad?e.map(function(e){b.onLoad(a,function(f,c){if(f)return e.setError(f);b.cache[a]||
b.loadSource(b.compile(c,a));b.cache[a](e,d).end()})}):e.setError(Error("Template Not Found: "+a))};b.loadSource=function(a){return eval(a)};b.isArray=Array.isArray?Array.isArray:function(a){return"[object Array]"==Object.prototype.toString.call(a)};b.nextTick=function(){return"undefined"!==typeof process?process.nextTick:function(a){setTimeout(a,0)}}();b.isEmpty=function(a){return b.isArray(a)&&!a.length?!0:0===a?!1:!a};b.filter=function(a,e,d){if(d)for(var f=0,c=d.length;f<c;f++){var l=d[f];"s"===
l?e=null:"function"===typeof b.filters[l]&&(a=b.filters[l](a))}e&&(a=b.filters[e](a));return a};b.filters={h:function(a){return b.escapeHtml(a)},j:function(a){return b.escapeJs(a)},u:encodeURI,uc:encodeURIComponent,js:function(a){return!JSON?a:JSON.stringify(a)},jp:function(a){return!JSON?a:JSON.parse(a)}};b.makeBase=function(a){return new h(new j,a)};h.wrap=function(a){return a instanceof h?a:new h(new j(a))};h.prototype.get=function(a){for(var e=this.stack,d;e;){if(e.isObject&&(d=e.head[a],void 0!==
d))return d;e=e.tail}return this.global?this.global[a]:void 0};h.prototype.getPath=function(a,e){var d=this.stack,f=e.length;if(a&&0===f)return d.head;for(var d=d.head,c=0;d&&c<f;)d=d[e[c]],c++;return d};h.prototype.push=function(a,e,d){return new h(new j(a,this.stack,e,d),this.global,this.blocks)};h.prototype.rebase=function(a){return new h(new j(a),this.global,this.blocks)};h.prototype.current=function(){return this.stack.head};h.prototype.getBlock=function(a,e,d){"function"===typeof a&&(a=a(e,
d).data,e.data="");if(e=this.blocks)for(var d=e.length,f;d--;)if(f=e[d][a])return f};h.prototype.shiftBlocks=function(a){var e=this.blocks;return a?(a=e?e.concat([a]):[a],new h(this.stack,this.global,a)):this};g.prototype.flush=function(){for(var a=this.head;a;){if(a.flushable)this.out+=a.data;else{a.error&&(this.callback(a.error),this.flush=function(){});return}this.head=a=a.next}this.callback(null,this.out)};f.prototype.flush=function(){for(var a=this.head;a;){if(a.flushable)this.emit("data",a.data);
else{a.error&&(this.emit("error",a.error),this.flush=function(){});return}this.head=a=a.next}this.emit("end")};f.prototype.emit=function(a,e){if(!this.events)return!1;var d=this.events[a];if(!d)return!1;if("function"==typeof d)d(e);else for(var d=d.slice(0),f=0,c=d.length;f<c;f++)d[f](e)};f.prototype.on=function(a,e){this.events||(this.events={});this.events[a]?"function"===typeof this.events[a]?this.events[a]=[this.events[a],e]:this.events[a].push(e):this.events[a]=e;return this};f.prototype.pipe=
function(a){this.on("data",function(e){a.write(e,"utf8")}).on("end",function(){a.end()}).on("error",function(e){a.error(e)});return this};c.prototype.write=function(a){var e=this.taps;e&&(a=e.go(a));this.data+=a;return this};c.prototype.end=function(a){a&&this.write(a);this.flushable=!0;this.root.flush();return this};c.prototype.map=function(a){var e=new c(this.root,this.next,this.taps),d=new c(this.root,e,this.taps);this.next=d;this.flushable=!0;a(d);return e};c.prototype.tap=function(e){var d=this.taps;
this.taps=d?d.push(e):new a(e);return this};c.prototype.untap=function(){this.taps=this.taps.tail;return this};c.prototype.render=function(a,e){return a(this,e)};c.prototype.reference=function(a,e,d,f){return"function"===typeof a&&(a.isFunction=!0,a=a.apply(e.current(),[this,e,null,{auto:d,filters:f}]),a instanceof c)?a:b.isEmpty(a)?this:this.write(b.filter(a,d,f))};c.prototype.section=function(a,e,d,f){if("function"===typeof a&&(a=a.apply(e.current(),[this,e,d,f]),a instanceof c))return a;var l=
d.block,d=d["else"];f&&(e=e.push(f));if(b.isArray(a)){if(l){var f=a.length,k=this;if(0<f){e.stack.head&&(e.stack.head.$len=f);for(d=0;d<f;d++)e.stack.head&&(e.stack.head.$idx=d),k=l(k,e.push(a[d],d,f));e.stack.head&&(e.stack.head.$idx=void 0,e.stack.head.$len=void 0);return k}if(d)return d(this,e)}}else if(!0===a){if(l)return l(this,e)}else if(a||0===a){if(l)return e.stack.head&&"object"===typeof a&&(e.stack.head.$idx=0,e.stack.head.$len=1),k=l(this,e.push(a)),e.stack.head&&"object"===typeof a&&(e.stack.head.$idx=
void 0,e.stack.head.$len=void 0),k}else if(d)return d(this,e);return this};c.prototype.exists=function(a,e,d){var f=d.block,d=d["else"];if(b.isEmpty(a)){if(d)return d(this,e)}else if(f)return f(this,e);return this};c.prototype.notexists=function(a,e,d){var f=d.block,d=d["else"];if(b.isEmpty(a)){if(f)return f(this,e)}else if(d)return d(this,e);return this};c.prototype.block=function(a,e,d){d=d.block;a&&(d=a);return d?d(this,e):this};c.prototype.partial=function(a,e,d){var f;d?(f=b.makeBase(e.global),
f.blocks=e.blocks,e.stack&&e.stack.tail&&(f.stack=e.stack.tail),f=f.push(d),f=f.push(e.stack.head)):f=e;return"function"===typeof a?this.capture(a,f,function(a,e){b.load(a,e,f).end()}):b.load(a,this,f)};c.prototype.helper=function(a,e,d,f){if(b.helpers[a])return b.helpers[a](this,e,d,f)};c.prototype.capture=function(a,e,d){return this.map(function(f){var c=new g(function(a,e){a?f.setError(a):d(e,f)});a(c.head,e).end()})};c.prototype.setError=function(a){this.error=a;this.root.flush();return this};
a.prototype.push=function(e){return new a(e,this)};a.prototype.go=function(a){for(var e=this;e;)a=e.head(a),e=e.tail;return a};var d=RegExp(/[&<>\"\']/),e=/&/g,l=/</g,k=/>/g,o=/\"/g,q=/\'/g;b.escapeHtml=function(a){return"string"===typeof a?!d.test(a)?a:a.replace(e,"&amp;").replace(l,"&lt;").replace(k,"&gt;").replace(o,"&quot;").replace(q,"&#39;"):a};var p=/\\/g,n=/\r/g,r=/\u2028/g,s=/\u2029/g,y=/\n/g,w=/\f/g,v=/'/g,t=/"/g,A=/\t/g;b.escapeJs=function(a){return"string"===typeof a?a.replace(p,"\\\\").replace(t,
'\\"').replace(v,"\\'").replace(n,"\\r").replace(r,"\\u2028").replace(s,"\\u2029").replace(y,"\\n").replace(w,"\\f").replace(A,"\\t"):a}})(dust);"undefined"!==typeof exports&&("undefined"!==typeof process&&require("./server")(dust),module.exports=dust);
(function(b){function h(a,d){for(var f=[d[0]],c=1,g=d.length;c<g;c++){var h=b.filterNode(a,d[c]);h&&f.push(h)}return f}function j(a,d){return d}function g(){}function f(a,d){for(var f="",c=1,g=d.length;c<g;c++)f=f+b.compileNode(a,d[c]);return f}function c(a,d,f){return"."+f+"("+b.compileNode(a,d[1])+","+b.compileNode(a,d[2])+","+b.compileNode(a,d[4])+","+b.compileNode(a,d[3])+")"}b.compile=function(a,d){try{var f,c=b.parse(a);f=b.filterNode({},c);var c={name:d,bodies:[],blocks:{},index:0,auto:"h"},
g="(function(){dust.register("+(d?'"'+d+'"':"null")+","+b.compileNode(c,f)+");",h;f=[];var j=c.blocks,r;for(r in j)f.push("'"+r+"':"+j[r]);if(f.length){c.blocks="ctx=ctx.shiftBlocks(blocks);";h="var blocks={"+f.join(",")+"};"}else h=c.blocks="";var g=g+h,s;h=[];for(var y=c.bodies,w=c.blocks,c=0,v=y.length;c<v;c++)h[c]="function body_"+c+"(chk,ctx){"+w+"return chk"+y[c]+";}";s=h.join("");return g+s+"return body_0;})();"}catch(t){if(!t.line||!t.column)throw t;throw new SyntaxError(t.message+" At line : "+
t.line+", column : "+t.column);}};b.filterNode=function(a,d){return b.optimizers[d[0]](a,d)};b.optimizers={body:function(a,d){for(var f=[d[0]],c,g=1,h=d.length;g<h;g++){var j=b.filterNode(a,d[g]);if(j)if(j[0]==="buffer")if(c)c[1]=c[1]+j[1];else{c=j;f.push(j)}else{c=null;f.push(j)}}return f},buffer:j,special:function(e,d){return["buffer",a[d[1]]]},format:g,reference:h,"#":h,"?":h,"^":h,"<":h,"+":h,"@":h,"%":h,partial:h,context:h,params:h,bodies:h,param:h,filters:j,key:j,path:j,literal:j,comment:g};
b.pragmas={esc:function(a,d,c){var b=a.auto;d||(d="h");a.auto=d==="s"?"":d;d=f(a,c.block);a.auto=b;return d}};var a={s:" ",n:"\n",r:"\r",lb:"{",rb:"}"};b.compileNode=function(a,d){return b.nodes[d[0]](a,d)};b.nodes={body:function(a,d){var c=a.index++,b="body_"+c;a.bodies[c]=f(a,d);return b},buffer:function(a,f){return".write("+d(f[1])+")"},format:function(a,f){return".write("+d(f[1]+f[2])+")"},reference:function(a,d){return".reference("+b.compileNode(a,d[1])+",ctx,"+b.compileNode(a,d[2])+")"},"#":function(a,
d){return c(a,d,"section")},"?":function(a,d){return c(a,d,"exists")},"^":function(a,d){return c(a,d,"notexists")},"<":function(a,d){for(var f=d[4],c=1,g=f.length;c<g;c++){var h=f[c];if(h[1][1]==="block"){a.blocks[d[1].text]=b.compileNode(a,h[2]);break}}return""},"+":function(a,f){return typeof f[1].text==="undefined"&&typeof f[4]==="undefined"?".block(ctx.getBlock("+b.compileNode(a,f[1])+",chk, ctx),"+b.compileNode(a,f[2])+", {},"+b.compileNode(a,f[3])+")":".block(ctx.getBlock("+d(f[1].text)+"),"+
b.compileNode(a,f[2])+","+b.compileNode(a,f[4])+","+b.compileNode(a,f[3])+")"},"@":function(a,f){return".helper("+d(f[1].text)+","+b.compileNode(a,f[2])+","+b.compileNode(a,f[4])+","+b.compileNode(a,f[3])+")"},"%":function(a,d){var f=d[1][1];if(!b.pragmas[f])return"";for(var c=d[4],g={},h=1,j=c.length;h<j;h++){var r=c[h];g[r[1][1]]=r[2]}c=d[3];r={};h=1;for(j=c.length;h<j;h++){var s=c[h];r[s[1][1]]=s[2][1]}return b.pragmas[f](a,d[2][1]?d[2][1].text:null,g,r)},partial:function(a,d){return".partial("+
b.compileNode(a,d[1])+","+b.compileNode(a,d[2])+","+b.compileNode(a,d[3])+")"},context:function(a,d){return d[1]?"ctx.rebase("+b.compileNode(a,d[1])+")":"ctx"},params:function(a,d){for(var f=[],c=1,g=d.length;c<g;c++)f.push(b.compileNode(a,d[c]));return f.length?"{"+f.join(",")+"}":"null"},bodies:function(a,d){for(var f=[],c=1,g=d.length;c<g;c++)f.push(b.compileNode(a,d[c]));return"{"+f.join(",")+"}"},param:function(a,d){return b.compileNode(a,d[1])+":"+b.compileNode(a,d[2])},filters:function(a,d){for(var f=
[],c=1,b=d.length;c<b;c++)f.push('"'+d[c]+'"');return'"'+a.auto+'"'+(f.length?",["+f.join(",")+"]":"")},key:function(a,d){return'ctx.get("'+d[1]+'")'},path:function(a,d){for(var f=d[1],c=d[2],b=[],g=0,h=c.length;g<h;g++)b.push('"'+c[g]+'"');return"ctx.getPath("+f+",["+b.join(",")+"])"},literal:function(a,f){return d(f[1])}};var d=typeof JSON==="undefined"?function(a){return'"'+b.escapeJs(a)+'"'}:JSON.stringify})("undefined"!==typeof exports?exports:getGlobal());
(function(b){var h=function(){function b(f){return'"'+f.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var g={parse:function(f,c){function a(a){var d={},e;for(e in a)d[e]=a[e];return d}function d(a,d){for(var e=a.offset+d,c=a.offset;c<e;c++){var b=f.charAt(c);if(b==="\n"){a.seenCR||a.line++;a.column=1;a.seenCR=false}else if(b==="\r"||b===
"\u2028"||b==="\u2029"){a.line++;a.column=1;a.seenCR=true}else{a.column++;a.seenCR=false}}a.offset=a.offset+d}function e(d){if(!(i.offset<R.offset)){if(i.offset>R.offset){R=a(i);S=[]}S.push(d)}}function g(){var d,e,f;f=a(i);d=[];for(e=k();e!==null;){d.push(e);e=k()}d!==null&&(d=["body"].concat(d));d===null&&(i=a(f));return d}function k(){var a;a=F();if(a===null){a=o();if(a===null){a=w();if(a===null){a=t();if(a===null){a=y();a===null&&(a=H())}}}}return a}function o(){var c,b,k,h,j,o,n,v,t;m++;v=a(i);
t=a(i);c=q();if(c!==null){b=[];for(k=z();k!==null;){b.push(k);k=z()}if(b!==null){k=G();if(k!==null){h=g();if(h!==null){j=s();if(j!==null){o=p();if(o!==null){n=c[1].text===o.text?"":null;if(n!==null)c=[c,b,k,h,j,o,n];else{c=null;i=a(t)}}else{c=null;i=a(t)}}else{c=null;i=a(t)}}else{c=null;i=a(t)}}else{c=null;i=a(t)}}else{c=null;i=a(t)}}else{c=null;i=a(t)}c!==null&&(c=function(a,d,e,f,c,b){b.push(["param",["literal","block"],c]);f.push(b);return f}(v.offset,v.line,v.column,c[0],c[3],c[4],c[5]));c===
null&&(i=a(v));if(c===null){v=a(i);t=a(i);c=q();if(c!==null){b=[];for(k=z();k!==null;){b.push(k);k=z()}if(b!==null){if(f.charCodeAt(i.offset)===47){k="/";d(i,1)}else{k=null;m===0&&e('"/"')}if(k!==null){h=G();if(h!==null)c=[c,b,k,h];else{c=null;i=a(t)}}else{c=null;i=a(t)}}else{c=null;i=a(t)}}else{c=null;i=a(t)}c!==null&&(c=function(a,d,e,f){f.push(["bodies"]);return f}(v.offset,v.line,v.column,c[0]));c===null&&(i=a(v))}m--;m===0&&c===null&&e("section");return c}function q(){var c,b,g,k,l,h,j,o;j=a(i);
o=a(i);c=I();if(c!==null){if(/^[#?^<+@%]/.test(f.charAt(i.offset))){b=f.charAt(i.offset);d(i,1)}else{b=null;m===0&&e("[#?^<+@%]")}if(b!==null){g=[];for(k=z();k!==null;){g.push(k);k=z()}if(g!==null){k=A();if(k!==null){l=n();if(l!==null){h=r();if(h!==null)c=[c,b,g,k,l,h];else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}c!==null&&(c=[c[1],c[3],c[4],c[5]]);c===null&&(i=a(j));return c}function p(){var c,b,g,k,l,h,j,o;m++;j=a(i);o=a(i);
c=I();if(c!==null){if(f.charCodeAt(i.offset)===47){b="/";d(i,1)}else{b=null;m===0&&e('"/"')}if(b!==null){g=[];for(k=z();k!==null;){g.push(k);k=z()}if(g!==null){k=A();if(k!==null){l=[];for(h=z();h!==null;){l.push(h);h=z()}if(l!==null){h=G();if(h!==null)c=[c,b,g,k,l,h];else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}c!==null&&(c=c[3]);c===null&&(i=a(j));m--;m===0&&c===null&&e("end tag");return c}function n(){var c,b,g,k,l;g=a(i);
k=a(i);l=a(i);if(f.charCodeAt(i.offset)===58){c=":";d(i,1)}else{c=null;m===0&&e('":"')}if(c!==null){b=A();if(b!==null)c=[c,b];else{c=null;i=a(l)}}else{c=null;i=a(l)}c!==null&&(c=c[1]);c===null&&(i=a(k));c=c!==null?c:"";c!==null&&(c=c?["context",c]:["context"]);c===null&&(i=a(g));return c}function r(){var c,b,g,k,l,h,j,o;m++;h=a(i);c=[];j=a(i);o=a(i);g=z();if(g!==null)for(b=[];g!==null;){b.push(g);g=z()}else b=null;if(b!==null){g=C();if(g!==null){if(f.charCodeAt(i.offset)===61){k="=";d(i,1)}else{k=
null;m===0&&e('"="')}if(k!==null){l=u();if(l===null){l=A();l===null&&(l=B())}if(l!==null)b=[b,g,k,l];else{b=null;i=a(o)}}else{b=null;i=a(o)}}else{b=null;i=a(o)}}else{b=null;i=a(o)}b!==null&&(b=["param",["literal",b[1]],b[3]]);for(b===null&&(i=a(j));b!==null;){c.push(b);j=a(i);o=a(i);g=z();if(g!==null)for(b=[];g!==null;){b.push(g);g=z()}else b=null;if(b!==null){g=C();if(g!==null){if(f.charCodeAt(i.offset)===61){k="=";d(i,1)}else{k=null;m===0&&e('"="')}if(k!==null){l=u();if(l===null){l=A();l===null&&
(l=B())}if(l!==null)b=[b,g,k,l];else{b=null;i=a(o)}}else{b=null;i=a(o)}}else{b=null;i=a(o)}}else{b=null;i=a(o)}b!==null&&(b=["param",["literal",b[1]],b[3]]);b===null&&(i=a(j))}c!==null&&(c=["params"].concat(c));c===null&&(i=a(h));m--;m===0&&c===null&&e("params");return c}function s(){var c,b,k,h,j,o,q,p,n;m++;q=a(i);c=[];p=a(i);n=a(i);b=I();if(b!==null){if(f.charCodeAt(i.offset)===58){k=":";d(i,1)}else{k=null;m===0&&e('":"')}if(k!==null){h=C();if(h!==null){j=G();if(j!==null){o=g();if(o!==null)b=[b,
k,h,j,o];else{b=null;i=a(n)}}else{b=null;i=a(n)}}else{b=null;i=a(n)}}else{b=null;i=a(n)}}else{b=null;i=a(n)}b!==null&&(b=["param",["literal",b[2]],b[4]]);for(b===null&&(i=a(p));b!==null;){c.push(b);p=a(i);n=a(i);b=I();if(b!==null){if(f.charCodeAt(i.offset)===58){k=":";d(i,1)}else{k=null;m===0&&e('":"')}if(k!==null){h=C();if(h!==null){j=G();if(j!==null){o=g();if(o!==null)b=[b,k,h,j,o];else{b=null;i=a(n)}}else{b=null;i=a(n)}}else{b=null;i=a(n)}}else{b=null;i=a(n)}}else{b=null;i=a(n)}b!==null&&(b=["param",
["literal",b[2]],b[4]]);b===null&&(i=a(p))}c!==null&&(c=["bodies"].concat(c));c===null&&(i=a(q));m--;m===0&&c===null&&e("bodies");return c}function y(){var d,f,c,b,g,k;m++;g=a(i);k=a(i);d=I();if(d!==null){f=A();if(f!==null){c=v();if(c!==null){b=G();if(b!==null)d=[d,f,c,b];else{d=null;i=a(k)}}else{d=null;i=a(k)}}else{d=null;i=a(k)}}else{d=null;i=a(k)}d!==null&&(d=["reference",d[1],d[2]]);d===null&&(i=a(g));m--;m===0&&d===null&&e("reference");return d}function w(){var c,b,g,k,l,h,j,o,q,p;m++;q=a(i);
p=a(i);c=I();if(c!==null){if(f.charCodeAt(i.offset)===62){b=">";d(i,1)}else{b=null;m===0&&e('">"')}if(b===null)if(f.charCodeAt(i.offset)===43){b="+";d(i,1)}else{b=null;m===0&&e('"+"')}if(b!==null){k=a(i);g=C();g!==null&&(g=["literal",g]);g===null&&(i=a(k));g===null&&(g=B());if(g!==null){k=n();if(k!==null){l=r();if(l!==null){h=[];for(j=z();j!==null;){h.push(j);j=z()}if(h!==null){if(f.charCodeAt(i.offset)===47){j="/";d(i,1)}else{j=null;m===0&&e('"/"')}if(j!==null){o=G();if(o!==null)c=[c,b,g,k,l,h,j,
o];else{c=null;i=a(p)}}else{c=null;i=a(p)}}else{c=null;i=a(p)}}else{c=null;i=a(p)}}else{c=null;i=a(p)}}else{c=null;i=a(p)}}else{c=null;i=a(p)}}else{c=null;i=a(p)}c!==null&&(c=[c[1]===">"?"partial":c[1],c[2],c[3],c[4]]);c===null&&(i=a(q));m--;m===0&&c===null&&e("partial");return c}function v(){var c,b,g,k,l,h;m++;k=a(i);c=[];l=a(i);h=a(i);if(f.charCodeAt(i.offset)===124){b="|";d(i,1)}else{b=null;m===0&&e('"|"')}if(b!==null){g=C();if(g!==null)b=[b,g];else{b=null;i=a(h)}}else{b=null;i=a(h)}b!==null&&
(b=b[1]);for(b===null&&(i=a(l));b!==null;){c.push(b);l=a(i);h=a(i);if(f.charCodeAt(i.offset)===124){b="|";d(i,1)}else{b=null;m===0&&e('"|"')}if(b!==null){g=C();if(g!==null)b=[b,g];else{b=null;i=a(h)}}else{b=null;i=a(h)}b!==null&&(b=b[1]);b===null&&(i=a(l))}c!==null&&(c=["filters"].concat(c));c===null&&(i=a(k));m--;m===0&&c===null&&e("filters");return c}function t(){var c,b,g,k,l,h;m++;l=a(i);h=a(i);c=I();if(c!==null){if(f.charCodeAt(i.offset)===126){b="~";d(i,1)}else{b=null;m===0&&e('"~"')}if(b!==
null){g=C();if(g!==null){k=G();if(k!==null)c=[c,b,g,k];else{c=null;i=a(h)}}else{c=null;i=a(h)}}else{c=null;i=a(h)}}else{c=null;i=a(h)}c!==null&&(c=["special",c[2]]);c===null&&(i=a(l));m--;m===0&&c===null&&e("special");return c}function A(){var d,f;m++;f=a(i);d=Q();d!==null&&(d=function(a,d,e,f){a=["path"].concat(f);a.text=f[1].join(".");return a}(f.offset,f.line,f.column,d));d===null&&(i=a(f));if(d===null){f=a(i);d=C();d!==null&&(d=function(a,d,e,f){a=["key",f];a.text=f;return a}(f.offset,f.line,
f.column,d));d===null&&(i=a(f))}m--;m===0&&d===null&&e("identifier");return d}function u(){var d,f;m++;f=a(i);d=L();d===null&&(d=J());d!==null&&(d=["literal",d]);d===null&&(i=a(f));m--;m===0&&d===null&&e("number");return d}function L(){var c,b,g,k,l,h;m++;l=a(i);h=a(i);c=J();if(c!==null){if(f.charCodeAt(i.offset)===46){b=".";d(i,1)}else{b=null;m===0&&e('"."')}if(b!==null){k=J();if(k!==null)for(g=[];k!==null;){g.push(k);k=J()}else g=null;if(g!==null)c=[c,b,g];else{c=null;i=a(h)}}else{c=null;i=a(h)}}else{c=
null;i=a(h)}c!==null&&(c=parseFloat(c[0]+"."+c[2].join("")));c===null&&(i=a(l));m--;m===0&&c===null&&e("frac");return c}function J(){var c,b,g;m++;g=a(i);if(/^[0-9]/.test(f.charAt(i.offset))){b=f.charAt(i.offset);d(i,1)}else{b=null;m===0&&e("[0-9]")}if(b!==null)for(c=[];b!==null;){c.push(b);if(/^[0-9]/.test(f.charAt(i.offset))){b=f.charAt(i.offset);d(i,1)}else{b=null;m===0&&e("[0-9]")}}else c=null;c!==null&&(c=parseInt(c.join(""),10));c===null&&(i=a(g));m--;m===0&&c===null&&e("integer");return c}
function Q(){var c,b,g,k,l;m++;k=a(i);l=a(i);c=C();c=c!==null?c:"";if(c!==null){g=E();g===null&&(g=D());if(g!==null)for(b=[];g!==null;){b.push(g);g=E();g===null&&(g=D())}else b=null;if(b!==null)c=[c,b];else{c=null;i=a(l)}}else{c=null;i=a(l)}if(c!==null){b=c[0];c=c[1];c=c[0];if(b&&c){c.unshift(b);c=[false,c]}else c=[true,c]}c===null&&(i=a(k));if(c===null){k=a(i);l=a(i);if(f.charCodeAt(i.offset)===46){c=".";d(i,1)}else{c=null;m===0&&e('"."')}if(c!==null){b=[];g=E();for(g===null&&(g=D());g!==null;){b.push(g);
g=E();g===null&&(g=D())}if(b!==null)c=[c,b];else{c=null;i=a(l)}}else{c=null;i=a(l)}c!==null&&(c=c[1].length>0?[true,c[1][0]]:[true,[]]);c===null&&(i=a(k))}m--;m===0&&c===null&&e("path");return c}function C(){var c,b,g,k,l;m++;k=a(i);l=a(i);if(/^[a-zA-Z_$]/.test(f.charAt(i.offset))){c=f.charAt(i.offset);d(i,1)}else{c=null;m===0&&e("[a-zA-Z_$]")}if(c!==null){b=[];if(/^[0-9a-zA-Z_$\-]/.test(f.charAt(i.offset))){g=f.charAt(i.offset);d(i,1)}else{g=null;m===0&&e("[0-9a-zA-Z_$\\-]")}for(;g!==null;){b.push(g);
if(/^[0-9a-zA-Z_$\-]/.test(f.charAt(i.offset))){g=f.charAt(i.offset);d(i,1)}else{g=null;m===0&&e("[0-9a-zA-Z_$\\-]")}}if(b!==null)c=[c,b];else{c=null;i=a(l)}}else{c=null;i=a(l)}c!==null&&(c=c[0]+c[1].join(""));c===null&&(i=a(k));m--;m===0&&c===null&&e("key");return c}function D(){var c,b,g,k,l,h,j;m++;k=a(i);l=a(i);h=a(i);j=a(i);if(f.charCodeAt(i.offset)===91){c="[";d(i,1)}else{c=null;m===0&&e('"["')}if(c!==null){if(/^[0-9]/.test(f.charAt(i.offset))){g=f.charAt(i.offset);d(i,1)}else{g=null;m===0&&
e("[0-9]")}if(g!==null)for(b=[];g!==null;){b.push(g);if(/^[0-9]/.test(f.charAt(i.offset))){g=f.charAt(i.offset);d(i,1)}else{g=null;m===0&&e("[0-9]")}}else b=null;if(b!==null){if(f.charCodeAt(i.offset)===93){g="]";d(i,1)}else{g=null;m===0&&e('"]"')}if(g!==null)c=[c,b,g];else{c=null;i=a(j)}}else{c=null;i=a(j)}}else{c=null;i=a(j)}c!==null&&(c=c[1].join(""));c===null&&(i=a(h));if(c!==null){b=E();b=b!==null?b:"";if(b!==null)c=[c,b];else{c=null;i=a(l)}}else{c=null;i=a(l)}if(c!==null){b=c[0];(c=c[1])?c.unshift(b):
c=[b]}c===null&&(i=a(k));m--;m===0&&c===null&&e("array");return c}function E(){var c,b,g,k,l,h,j;m++;k=a(i);l=a(i);h=a(i);j=a(i);if(f.charCodeAt(i.offset)===46){b=".";d(i,1)}else{b=null;m===0&&e('"."')}if(b!==null){g=C();if(g!==null)b=[b,g];else{b=null;i=a(j)}}else{b=null;i=a(j)}b!==null&&(b=b[1]);b===null&&(i=a(h));if(b!==null)for(c=[];b!==null;){c.push(b);h=a(i);j=a(i);if(f.charCodeAt(i.offset)===46){b=".";d(i,1)}else{b=null;m===0&&e('"."')}if(b!==null){g=C();if(g!==null)b=[b,g];else{b=null;i=a(j)}}else{b=
null;i=a(j)}b!==null&&(b=b[1]);b===null&&(i=a(h))}else c=null;if(c!==null){b=D();b=b!==null?b:"";if(b!==null)c=[c,b];else{c=null;i=a(l)}}else{c=null;i=a(l)}if(c!==null){b=c[0];c=(c=c[1])?b.concat(c):b}c===null&&(i=a(k));m--;m===0&&c===null&&e("array_part");return c}function B(){var c,b,g,k,l;m++;k=a(i);l=a(i);if(f.charCodeAt(i.offset)===34){c='"';d(i,1)}else{c=null;m===0&&e('"\\""')}if(c!==null){if(f.charCodeAt(i.offset)===34){b='"';d(i,1)}else{b=null;m===0&&e('"\\""')}if(b!==null)c=[c,b];else{c=
null;i=a(l)}}else{c=null;i=a(l)}c!==null&&(c=["literal",""]);c===null&&(i=a(k));if(c===null){k=a(i);l=a(i);if(f.charCodeAt(i.offset)===34){c='"';d(i,1)}else{c=null;m===0&&e('"\\""')}if(c!==null){b=K();if(b!==null){if(f.charCodeAt(i.offset)===34){g='"';d(i,1)}else{g=null;m===0&&e('"\\""')}if(g!==null)c=[c,b,g];else{c=null;i=a(l)}}else{c=null;i=a(l)}}else{c=null;i=a(l)}c!==null&&(c=["literal",c[1]]);c===null&&(i=a(k));if(c===null){k=a(i);l=a(i);if(f.charCodeAt(i.offset)===34){c='"';d(i,1)}else{c=null;
m===0&&e('"\\""')}if(c!==null){g=N();if(g!==null)for(b=[];g!==null;){b.push(g);g=N()}else b=null;if(b!==null){if(f.charCodeAt(i.offset)===34){g='"';d(i,1)}else{g=null;m===0&&e('"\\""')}if(g!==null)c=[c,b,g];else{c=null;i=a(l)}}else{c=null;i=a(l)}}else{c=null;i=a(l)}c!==null&&(c=["body"].concat(c[1]));c===null&&(i=a(k))}}m--;m===0&&c===null&&e("inline");return c}function N(){var d,e;d=t();if(d===null){d=y();if(d===null){e=a(i);d=K();d!==null&&(d=["buffer",d]);d===null&&(i=a(e))}}return d}function H(){var c,
b,g,k,l,h,j,o;m++;h=a(i);j=a(i);c=P();if(c!==null){b=[];for(g=z();g!==null;){b.push(g);g=z()}if(b!==null)c=[c,b];else{c=null;i=a(j)}}else{c=null;i=a(j)}c!==null&&(c=["format",c[0],c[1].join("")]);c===null&&(i=a(h));if(c===null){h=a(i);j=a(i);o=a(i);l=a(i);m++;b=M();m--;if(b===null)b="";else{b=null;i=a(l)}if(b!==null){l=a(i);m++;g=P();m--;if(g===null)g="";else{g=null;i=a(l)}if(g!==null){l=a(i);m++;k=F();m--;if(k===null)k="";else{k=null;i=a(l)}if(k!==null){if(f.length>i.offset){l=f.charAt(i.offset);
d(i,1)}else{l=null;m===0&&e("any character")}if(l!==null)b=[b,g,k,l];else{b=null;i=a(o)}}else{b=null;i=a(o)}}else{b=null;i=a(o)}}else{b=null;i=a(o)}b!==null&&(b=b[3]);b===null&&(i=a(j));if(b!==null)for(c=[];b!==null;){c.push(b);j=a(i);o=a(i);l=a(i);m++;b=M();m--;if(b===null)b="";else{b=null;i=a(l)}if(b!==null){l=a(i);m++;g=P();m--;if(g===null)g="";else{g=null;i=a(l)}if(g!==null){l=a(i);m++;k=F();m--;if(k===null)k="";else{k=null;i=a(l)}if(k!==null){if(f.length>i.offset){l=f.charAt(i.offset);d(i,1)}else{l=
null;m===0&&e("any character")}if(l!==null)b=[b,g,k,l];else{b=null;i=a(o)}}else{b=null;i=a(o)}}else{b=null;i=a(o)}}else{b=null;i=a(o)}b!==null&&(b=b[3]);b===null&&(i=a(j))}else c=null;c!==null&&(c=["buffer",c.join("")]);c===null&&(i=a(h))}m--;m===0&&c===null&&e("buffer");return c}function K(){var c,b,g,k,l,h;m++;k=a(i);l=a(i);h=a(i);g=a(i);m++;b=M();m--;if(b===null)b="";else{b=null;i=a(g)}if(b!==null){g=x();if(g===null)if(/^[^"]/.test(f.charAt(i.offset))){g=f.charAt(i.offset);d(i,1)}else{g=null;m===
0&&e('[^"]')}if(g!==null)b=[b,g];else{b=null;i=a(h)}}else{b=null;i=a(h)}b!==null&&(b=b[1]);b===null&&(i=a(l));if(b!==null)for(c=[];b!==null;){c.push(b);l=a(i);h=a(i);g=a(i);m++;b=M();m--;if(b===null)b="";else{b=null;i=a(g)}if(b!==null){g=x();if(g===null)if(/^[^"]/.test(f.charAt(i.offset))){g=f.charAt(i.offset);d(i,1)}else{g=null;m===0&&e('[^"]')}if(g!==null)b=[b,g];else{b=null;i=a(h)}}else{b=null;i=a(h)}b!==null&&(b=b[1]);b===null&&(i=a(l))}else c=null;c!==null&&(c=c.join(""));c===null&&(i=a(k));
m--;m===0&&c===null&&e("literal");return c}function x(){var c,b;b=a(i);if(f.substr(i.offset,2)==='\\"'){c='\\"';d(i,2)}else{c=null;m===0&&e('"\\\\\\""')}c!==null&&(c='"');c===null&&(i=a(b));return c}function F(){var c,b,g,k,l,h,j,o;m++;l=a(i);h=a(i);if(f.substr(i.offset,2)==="{!"){c="{!";d(i,2)}else{c=null;m===0&&e('"{!"')}if(c!==null){b=[];j=a(i);o=a(i);k=a(i);m++;if(f.substr(i.offset,2)==="!}"){g="!}";d(i,2)}else{g=null;m===0&&e('"!}"')}m--;if(g===null)g="";else{g=null;i=a(k)}if(g!==null){if(f.length>
i.offset){k=f.charAt(i.offset);d(i,1)}else{k=null;m===0&&e("any character")}if(k!==null)g=[g,k];else{g=null;i=a(o)}}else{g=null;i=a(o)}g!==null&&(g=g[1]);for(g===null&&(i=a(j));g!==null;){b.push(g);j=a(i);o=a(i);k=a(i);m++;if(f.substr(i.offset,2)==="!}"){g="!}";d(i,2)}else{g=null;m===0&&e('"!}"')}m--;if(g===null)g="";else{g=null;i=a(k)}if(g!==null){if(f.length>i.offset){k=f.charAt(i.offset);d(i,1)}else{k=null;m===0&&e("any character")}if(k!==null)g=[g,k];else{g=null;i=a(o)}}else{g=null;i=a(o)}g!==
null&&(g=g[1]);g===null&&(i=a(j))}if(b!==null){if(f.substr(i.offset,2)==="!}"){g="!}";d(i,2)}else{g=null;m===0&&e('"!}"')}if(g!==null)c=[c,b,g];else{c=null;i=a(h)}}else{c=null;i=a(h)}}else{c=null;i=a(h)}c!==null&&(c=["comment",c[1].join("")]);c===null&&(i=a(l));m--;m===0&&c===null&&e("comment");return c}function M(){var c,b,g,k,l,h,j,o,q;o=a(i);c=I();if(c!==null){if(/^[#?^><+%:@\/~%]/.test(f.charAt(i.offset))){b=f.charAt(i.offset);d(i,1)}else{b=null;m===0&&e("[#?^><+%:@\\/~%]")}if(b!==null){g=[];
for(k=z();k!==null;){g.push(k);k=z()}if(g!==null){q=a(i);j=a(i);m++;l=G();m--;if(l===null)l="";else{l=null;i=a(j)}if(l!==null){j=a(i);m++;h=P();m--;if(h===null)h="";else{h=null;i=a(j)}if(h!==null){if(f.length>i.offset){j=f.charAt(i.offset);d(i,1)}else{j=null;m===0&&e("any character")}if(j!==null)l=[l,h,j];else{l=null;i=a(q)}}else{l=null;i=a(q)}}else{l=null;i=a(q)}if(l!==null)for(k=[];l!==null;){k.push(l);q=a(i);j=a(i);m++;l=G();m--;if(l===null)l="";else{l=null;i=a(j)}if(l!==null){j=a(i);m++;h=P();
m--;if(h===null)h="";else{h=null;i=a(j)}if(h!==null){if(f.length>i.offset){j=f.charAt(i.offset);d(i,1)}else{j=null;m===0&&e("any character")}if(j!==null)l=[l,h,j];else{l=null;i=a(q)}}else{l=null;i=a(q)}}else{l=null;i=a(q)}}else k=null;if(k!==null){l=[];for(h=z();h!==null;){l.push(h);h=z()}if(l!==null){h=G();if(h!==null)c=[c,b,g,k,l,h];else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}}else{c=null;i=a(o)}c===null&&(c=y());return c}function I(){var a;
if(f.charCodeAt(i.offset)===123){a="{";d(i,1)}else{a=null;m===0&&e('"{"')}return a}function G(){var a;if(f.charCodeAt(i.offset)===125){a="}";d(i,1)}else{a=null;m===0&&e('"}"')}return a}function P(){var a;if(f.charCodeAt(i.offset)===10){a="\n";d(i,1)}else{a=null;m===0&&e('"\\n"')}if(a===null){if(f.substr(i.offset,2)==="\r\n"){a="\r\n";d(i,2)}else{a=null;m===0&&e('"\\r\\n"')}if(a===null){if(f.charCodeAt(i.offset)===13){a="\r";d(i,1)}else{a=null;m===0&&e('"\\r"')}if(a===null){if(f.charCodeAt(i.offset)===
8232){a="\u2028";d(i,1)}else{a=null;m===0&&e('"\\u2028"')}if(a===null)if(f.charCodeAt(i.offset)===8233){a="\u2029";d(i,1)}else{a=null;m===0&&e('"\\u2029"')}}}}return a}function z(){var a;if(/^[\t\x0B\f \xA0\uFEFF]/.test(f.charAt(i.offset))){a=f.charAt(i.offset);d(i,1)}else{a=null;m===0&&e("[\\t\\x0B\\f \\xA0\\uFEFF]")}a===null&&(a=P());return a}function U(a){a.sort();for(var d=null,c=[],e=0;e<a.length;e++)if(a[e]!==d){c.push(a[e]);d=a[e]}return c}var O={body:g,part:k,section:o,sec_tag_start:q,end_tag:p,
context:n,params:r,bodies:s,reference:y,partial:w,filters:v,special:t,identifier:A,number:u,frac:L,integer:J,path:Q,key:C,array:D,array_part:E,inline:B,inline_part:N,buffer:H,literal:K,esc:x,comment:F,tag:M,ld:I,rd:G,eol:P,ws:z};if(c!==void 0){if(O[c]===void 0)throw Error("Invalid rule name: "+b(c)+".");}else c="body";var i={offset:0,line:1,column:1,seenCR:false},m=0,R={offset:0,line:1,column:1,seenCR:false},S=[],O=O[c]();if(O===null||i.offset!==f.length){var O=Math.max(i.offset,R.offset),V=O<f.length?
f.charAt(O):null,T=i.offset>R.offset?i:R;throw new h.SyntaxError(U(S),V,O,T.line,T.column);}return O},toSource:function(){return this._source},SyntaxError:function(f,c,a,d,e){this.name="SyntaxError";this.expected=f;this.found=c;switch(f.length){case 0:f="end of input";break;case 1:f=f[0];break;default:f=f.slice(0,f.length-1).join(", ")+" or "+f[f.length-1]}c=c?b(c):"end of input";this.message="Expected "+f+" but "+c+" found.";this.offset=a;this.line=d;this.column=e}};g.SyntaxError.prototype=Error.prototype;
return g}();b.parse=h.parse})("undefined"!==typeof exports?exports:getGlobal());
(function(){function b(c){c=c.current();return typeof c==="object"&&c.isSelect===true}function h(c,a){return typeof a==="function"?a.toString():a}function j(c,a,d,e,l){var e=e||{},k=d.block,h,j,p=e.filterOpType||"";if(typeof e.key!=="undefined")h=dust.helpers.tap(e.key,c,a);else if(b(a)){h=a.current().selectKey;a.current().isResolved&&(l=function(){return false})}else{f.log("No key specified for filter in:"+p+" helper ");return c}j=dust.helpers.tap(e.value,c,a);if(l(g(j,e.type,a),g(h,e.type,a))){if(b(a))a.current().isResolved=
true;if(k)return c.render(k,a);f.log("Missing body block in the "+p+" helper ")}else if(d["else"])return c.render(d["else"],a);return c}function g(c,a,d){if(c)switch(a||typeof c){case "number":return+c;case "string":return""+c;case "boolean":return Boolean(c==="false"?false:c);case "date":return new Date(c);case "context":return d.get(c)}return c}typeof exports!=="undefined"&&(dust=require("dustjs-linkedin"));var f=typeof console!=="undefined"?console:{log:function(){}};dust.helpers={tap:function(c,
a,d){var e=c;if(typeof c==="function")if(c.isFunction===true)e=c();else{e="";a.tap(function(a){e=e+a;return""}).render(c,d).untap();e===""&&(e=false)}return e},sep:function(c,a,d){return a.stack.index===a.stack.of-1?c:d.block?d.block(c,a):c},idx:function(c,a,d){return d.block?d.block(c,a.push(a.stack.index)):c},contextDump:function(c,a,d,e){e=e||{};d=e.to||"output";e=e.key||"current";d=dust.helpers.tap(d,c,a);e=dust.helpers.tap(e,c,a);a=e==="full"?JSON.stringify(a.stack,h,2):JSON.stringify(a.stack.head,
h,2);if(d==="console"){f.log(a);return c}return c.write(a)},"if":function(c,a,d,e){var b=d.block,g=d["else"];if(e&&e.cond){e=e.cond;e=dust.helpers.tap(e,c,a);if(eval(e)){if(b)return c.render(d.block,a);f.log("Missing body block in the if helper!");return c}if(g)return c.render(d["else"],a)}else f.log("No condition given in the if helper!");return c},math:function(c,a,d,e){if(e&&typeof e.key!=="undefined"&&e.method){var b=e.key,g=e.method,e=e.operand,h=null,b=dust.helpers.tap(b,c,a),e=dust.helpers.tap(e,
c,a);switch(g){case "mod":(e===0||e===-0.0)&&f.log("operand for divide operation is 0/-0: expect Nan!");h=parseFloat(b)%parseFloat(e);break;case "add":h=parseFloat(b)+parseFloat(e);break;case "subtract":h=parseFloat(b)-parseFloat(e);break;case "multiply":h=parseFloat(b)*parseFloat(e);break;case "divide":(e===0||e===-0.0)&&f.log("operand for divide operation is 0/-0: expect Nan/Infinity!");h=parseFloat(b)/parseFloat(e);break;case "ceil":h=Math.ceil(parseFloat(b));break;case "floor":h=Math.floor(parseFloat(b));
break;case "abs":h=Math.abs(parseFloat(b));break;default:f.log("method passed is not supported")}if(h!==null)return d&&d.block?c.render(d.block,a.push({isSelect:true,isResolved:false,selectKey:h})):c.write(h)}else f.log("Key is a required parameter for math helper along with method/operand!");return c},select:function(c,a,d,e){var b=d.block;if(e&&typeof e.key!=="undefined"){e=dust.helpers.tap(e.key,c,a);if(b)return c.render(d.block,a.push({isSelect:true,isResolved:false,selectKey:e}));f.log("Missing body block in the select helper ")}else f.log("No key given in the select helper!");
return c},eq:function(c,a,d,e){if(e)e.filterOpType="eq";return j(c,a,d,e,function(a,d){return d===a})},ne:function(c,a,d,e){if(e){e.filterOpType="ne";return j(c,a,d,e,function(a,d){return d!==a})}return c},lt:function(c,a,d,e){if(e){e.filterOpType="lt";return j(c,a,d,e,function(a,d){return d<a})}},lte:function(c,a,d,e){if(e){e.filterOpType="lte";return j(c,a,d,e,function(a,d){return d<=a})}return c},gt:function(c,a,d,e){if(e){e.filterOpType="gt";return j(c,a,d,e,function(a,d){return d>a})}return c},
gte:function(c,a,d,e){if(e){e.filterOpType="gte";return j(c,a,d,e,function(a,d){return d>=a})}return c},"default":function(c,a,d,e){if(e)e.filterOpType="default";return j(c,a,d,e,function(){return true})},size:function(c,a,d,e){var a=0,f,e=e||{},e=e.key;if(!e||e===true)a=0;else if(dust.isArray(e))a=e.length;else if(!isNaN(parseFloat(e))&&isFinite(e))a=e;else if(typeof e==="object"){a=0;for(f in e)Object.hasOwnProperty.call(e,f)&&a++}else a=(e+"").length;return c.write(a)}};if(typeof exports!=="undefined")module.exports=
dust})();
var LZ77=function(b){var b=b||{},h=b.referenceIntBase||96,j=32+h-1,g=Math.pow(h,2)-1,f=b.minStringLength||5,c=Math.pow(h,1)-1+f,a=b.defaultWindowLength||144,d=g+f,e=function(a,d){if(a>=0&&a<Math.pow(h,d)-1){for(var c="";a>0;){c=String.fromCharCode(a%h+32)+c;a=Math.floor(a/h)}for(var e=d-c.length,f=0;f<e;f++)c=String.fromCharCode(32)+c;return c}throw"Reference int out of range: "+a+" (width = "+d+")";},l=function(a,d){for(var c=0,e=0;e<d;e++){var c=c*h,f=a.charCodeAt(e);if(f>=32&&f<=j)c=c+(f-32);else throw"Invalid char code in reference int: "+
f;}return c};this.compress=function(b,l){l=l||a;if(l>d)throw"Window length too large";for(var h="",j=0,n=b.length-f;j<n;){for(var r=Math.max(j-l,0),s=f,y=false,w=g,v=0,t=null;r+s<j;)if(b.substr(r,s)==b.substr(j,s)&&s<c){s++;y=true}else{s=s-1;if(y&&s>v){w=j-r-s;v=s}s=f;r++;y=false}if(v){t="`"+e(w,2)+e(v-f,1);j=j+v}else{t=b.charAt(j)!="`"?b.charAt(j):"``";j++}h=h+t}return h+b.slice(j).replace(/`/g,"``")};this.decompress=function(a){for(var d="",c=0;c<a.length;){var e=a.charAt(c);if(e!="`"){d=d+e;c++}else if(a.charAt(c+
1)!="`"){var e=l(a.substr(c+1,2),2),b;b=a.charAt(c+3);b=l(b,1)+f;d=d+d.substr(d.length-e-b,b);c=c+(f-1)}else{d=d+"`";c=c+2}}return d}};
(function(b,h){var j=0;b.$=h.noConflict?h.noConflict():h;b.resolve=function(b,f){if(!b)return null;for(var b=b.split("."),c=window,a=window,d=-1,e;e=b[++d];){a=a[e];if(!a)if(f)a=c[e]={};else return null;c=a}return a};b.extend=function(g,f,c){function a(){}if(typeof g=="object"){c=g;g=Object;f=function(){}}else if(typeof f=="object"){c=f;f=g;g=Object}a.prototype=g.prototype;f.prototype=new a;f.prototype.constructor=f;if(c)for(var d in c)f.prototype[d]=c[d];f.extend=function(a,d){if(typeof a=="object"){d=
a;a=function(){f.apply(this,arguments)}}b.extend(f,a,d);return a};return f};b.log=function(){window.console?console.log.apply(console,arguments):alert([].join.call(arguments," "))};b.uuid=function(){return j++};b.delay=function(b,f,c){return setTimeout(function(){b.call(f)},c||0)};b.clone=function(g,f){return g?g instanceof Array?g.slice(0):g instanceof Date?new Date(g.getTime()):typeof g=="object"?b.merge(f,{},g):g.valueOf():g};b.merge=function(g,f){var c=-1,a=[].slice.call(arguments,2),d,e;if(typeof g==
"object"){a.unshift(f);f=g;g=false}for(;d=a[++c];)for(e in d)d.hasOwnProperty(e)&&(f[e]=g?b.clone(d[e]):d[e]);return f};h.fn.dataAttrs=function(){for(var b={},f=this[0].attributes,c=-1,a;a=f[++c];)if(a.name.indexOf("data-")==0)b[a.name.slice(5)]=a.value;return b};if(!h.proxy)h.proxy=function(b,f){return function(){b.apply(f,arguments)}};if(!h.fn.detach)h.fn.detach=h.fn.remove})(window.Lavaca=window.Lavaca||{},window.jQuery||window.Zepto||window.jMiny);
(function(b){b.indexOf=function(b,j){if(b){if(b.indexOf)return b.indexOf(j);for(var g=0,f=b.length;g<f;g++)if(b[g]===j)return g}return-1};b.contains=function(h,j){return b.indexOf(h,j)>-1};b.remove=function(h,j){var g=b.indexOf(h,j);g>-1&&h.splice(g,1);return g};b.pushIfNotExists=function(h,j){var g=b.indexOf(h,j);if(g==-1)h[g=h.length]=j;return g}})(Lavaca.resolve("Lavaca.util.ArrayUtils",!0));
(function(b){function h(a){return parseInt(a,10)}function j(a,d){for(var a=a.toLowerCase(),c=-1,b;b=d[++c];)if(a==b.toLowerCase()||a==f(b).toLowerCase())return c-1;throw'Invalid code "'+b+'"';}function g(a,d,c){for(var f=a<0?"-":"",c=c||"0",a=Math.abs(a).toString();d-a.length>0;)a=c+a;return f+a}function f(a){Lavaca.util.Translation&&(result=Lavaca.util.Translation.get(a));return result?result:a}function c(a){for(var d=[],c="",f=-1,b,g;g=a.charAt(++f);){b=c.charAt(0);if(b==g||b=='"'||b=="'"){c=c+
g;if(b=='"'&&g=='"'||b=="'"&&g=="'"){d.push(c);c=""}}else{c&&d.push(c);c=g}}c&&d.push(c);return d}b.timeOfDayDesignatorAbbr=["A","P"];b.timeOfDayDesignator=["AM","PM"];b.daysOfWeekAbbr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];b.daysOfWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];b.monthsAbbr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];b.months=["January","February","March","April","May","June","July","August","September","October","November",
"December"];b.fn={d:{exp:"\\d{1,2}",i:function(a,d){d.date=h(a)},o:function(a,d){return(d?a.getUTCDate():a.getDate()).toString()}},dd:{exp:"\\d{2}",i:function(a,d){d.date=h(a)},o:function(a,d){return g(b.fn.d.o(a,d),2)}},ddd:{exp:"[a-z]{3}",i:function(){},o:function(a,d){return f(b.daysOfWeekAbbr[d?a.getUTCDay():a.getDay()])}},dddd:{exp:"[a-z]+",i:function(){},o:function(a,d){return f(b.daysOfWeek[d?a.getUTCDay():a.getDay()])}},f:{exp:"\\d",i:function(a,d){d.ms=h(a)*100},o:function(a,d,c){c=c||100;
return g(Math.floor((d?a.getUTCMilliseconds():a.getMilliseconds())/c),3-c.toString().length)}},ff:{exp:"\\d{2}",i:function(a,d){d.ms=h(a)*10},o:function(a,d){return g(b.fn.f.o(a,d,10),2)}},fff:{exp:"\\d{3}",i:function(a,d){d.ms=h(a,10)},o:function(a,d){return g(b.fn.f.o(a,d,1),3)}},h:{exp:"1?\\d",i:function(a,d,c){a=h(a)-1;c=(c.t||c.tt||"A").indexOf("A")==0?0:12;d.hour=a+c},o:function(a,d){return((d?a.getUTCHours():a.getHours())%12+1).toString()}},hh:{exp:"[0-1]\\d",i:function(a,d,c){b.fn.h.i(a,d,
c)},o:function(a,d){return g(b.fn.h.o(a,d),2)}},H:{exp:"[0-2]?\\d",i:function(a,d){d.hour=h(a)},o:function(a,d){return(d?a.getUTCHours():a.getHours()).toString()}},HH:{exp:"[0-2]\\d",i:function(a,d){d.hour=h(a)},o:function(a,d){return g(b.fn.H.o(a,d),2)}},m:{exp:"[1-5]?\\d",i:function(a,d){d.minute=h(a)},o:function(a,d){return(d?a.getUTCMinutes():a.getMinutes()).toString()}},mm:{exp:"[0-5]\\d",i:function(a,d,c){b.fn.m.i(a,d,c)},o:function(a,d){return g(b.fn.m.o(a,d),2)}},M:{exp:"1?\\d",i:function(a,
d){d.month=h(a)-1},o:function(a,d){return((d?a.getUTCMonth():a.getMonth())+1).toString()}},MM:{exp:"[0-1]\\d",i:function(a,d,c){b.fn.M.i(a,d,c)},o:function(a,d){return g(b.fn.M.o(a,d),2)}},MMM:{exp:"[a-z]{3}",i:function(a,d){d.month=j(a,b.monthsAbbr)},o:function(a,d){return f(b.monthsAbbr[d?a.getUTCMonth():a.getMonth()])}},MMMM:{exp:"[a-z]+",i:function(a,d){d.month=j(a,b.months)},o:function(a,d){return f(b.months[d?a.getUTCMonth():a.getMonth()])}},s:{exp:"[1-5]?\\d",i:function(a,d){d.second=h(a)},
o:function(a,d){return(d?a.getUTCSeconds():a.getSeconds()).toString()}},ss:{exp:"[0-5]\\d",i:function(a,d,c){b.fn.s.i(a,d,c)},o:function(a,d){return g(b.fn.s.o(a,d),2)}},t:{exp:"[a-z]",i:function(){},o:function(a,d){return f(b.timeOfDayDesignatorAbbr[Math.floor((d?a.getUTCHours():a.getHours())/12)])}},tt:{exp:"[a-z]+",i:function(){},o:function(a,d){return f(b.timeOfDayDesignator[Math.floor((d?a.getUTCHours():a.getHours())/12)])}},y:{exp:"\\d?\\d",i:function(a,d){d.year=(new Date).getFullYear()%100+
h(a)},o:function(a,d){return((d?a.getUTCFullYear():a.getFullYear())%100).toString()}},yy:{exp:"\\d{2}",i:function(a,d,c){b.fn.y.i(a,d,c)},o:function(a,d){return g(b.fn.y.o(a,d),2)}},yyy:{exp:"\\d*\\d{3}",i:function(a,d){d.year=h(a)},o:function(a,d){return g(d?a.getUTCFullYear():a.getFullYear(),3)}},yyyy:{exp:"\\d*\\d{4}",i:function(a,d,c){b.fn.yyy.i(a,d,c)},o:function(a,d){return g(d?a.getUTCFullYear():a.getFullYear(),4)}},z:{exp:"[-+]?1?\\d",i:function(a,d){d.offset=h(a)*60},o:function(a,d){var c=
a.getTimezoneOffset(),f=Math.floor(Math.abs(c/60));return(c<0?"-":"+")+g(f,d)}},zz:{exp:"[-+]?[0-1]\\d",i:function(a,d,c){b.fn.z.i(a,d,c)},o:function(a){return b.fn.z.o(a,2)}},zzz:{exp:"[-+]?[0-1]\\d:\\d{2}",i:function(a,d){var c=a.split(":");d.offset=h(c[0])*60+h(c[1])},o:function(a){var a=a.getTimezoneOffset(),d=a%60;return(a<0?"-":"+")+g((a-d)/60,2)+":"+g(Math.abs(d),2)}}};b.parse=function(a,d){for(var e=c(d),f,k=["^"],h=-1,j;j=e[++h];)(f=b.fn[j])?k.push("(",f.exp,")"):k.push("(",j.replace(/(^")|(^')|('$)|("$)/g,
"").replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),")");k.push("$");f=RegExp(k.join(""));k={year:0,month:0,date:1,hour:0,minute:0,second:0,ms:0,offset:0};h={};j=-1;var p;if(f.test(a))for(f=f.exec(a);p=e[++j];)h[p]=f[j+1];for(p in h)(e=b.fn[p])&&e.i(h[p],k,h);return new Date(b.monthsAbbr[k.month]+" "+g(k.date,2)+" "+g(k.year,4)+" "+g(k.hour,2)+":"+g(k.minute,2)+":"+g(k.second,2)+(k.ms>0?"."+g(k.ms,3):"")+(k.offset>=0?"+":"-")+g(Math.floor(Math.abs(k.offset/60)),2)+g(Math.abs(k.offset%60),2))};b.stringify=
function(a,d,e){for(var d=c(d),f=-1,g=[],h,j;h=d[++f];)(j=b.fn[h])?g.push(j.o(a,e)):g.push(h.replace(/(^")|(^')|('$)|("$)/g,""));return g.join("")}})(Lavaca.resolve("Lavaca.util.DateUtils",!0));(function(b){function h(b){var g,f,c;for(g in b){if(b.hasOwnProperty(g))if(f=b[g])if(typeof f.dispose=="function")f.dispose();else if(f instanceof Array)for(c=f.length-1;c>-1;c--)h(f[c]);delete b[g]}}b.Disposable=Lavaca.extend({dispose:function(){h(this)}})})(Lavaca.resolve("Lavaca.util",!0));
(function(b,h){b.Cache=h.extend({get:function(b,g){var f=this["@"+b];f===void 0&&g!==void 0&&(f=this["@"+b]=g);return f===void 0?null:f},set:function(b,g){this["@"+b]=g},add:function(b){var g=Lavaca.uuid();this.set(g,b);return g},remove:function(b){delete this["@"+b]},each:function(b,g){for(var f in this)this.hasOwnProperty(f)&&f.indexOf("@")==0&&b.call(g||this,f.slice(1),this[f])},toObject:function(){var b={};this.each(function(g,f){b[g]=f&&typeof f.toObject==="function"?f.toObject():f});return b},
toJSON:function(){return JSON.stringify(this.toObject())}})})(Lavaca.util,Lavaca.util.Disposable);
(function(b,h,j){b.Map=j.extend(function(b,f,c){j.call(this);this.hasLoaded=false;this.name=b;(b=f)&&b.indexOf("http")!=0&&(b=b.charAt(0)=="/"?location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+(b.indexOf("/")==0?b:"/"+b):location.toString().split("#")[0].split("?")[0].replace(/\w+\.\w+$/,"")+b);this.src=b;this.code=c;this.cache=new Lavaca.util.Cache},{is:function(b){return this.name==b},get:function(b){if(!this.hasLoaded){this.code?this.add(this.code):this.src&&this.load(this.src);
this.hasLoaded=true}return this.cache.get(b)},add:function(b){for(var f in b)this.cache.set(f,b[f])},process:function(b){this.add(typeof b=="string"?JSON.parse(b):b)},load:function(b){var f=this;Lavaca.net.Connectivity.ajax({async:false,url:b,success:function(c){f.process(c)}})}});b.Map.setDefault=function(b,f){var c=f;typeof c=="string"&&(c=b.get(f));b.set("default",c)};b.Map.get=function(b,f,c,a){if(!c){c=f;f=a}if(f)if(b=b.get(f))return b.get(c);return null};b.Map.init=function(g,f,c,a){h(a||document.documentElement).find('script[type="'+
f+'"]').each(function(){var a=h(this),e=a.attr("data-src"),f=a.attr("data-name"),k=a.attr("data-default")!==null,a=a.text(),e=c(f,e,a);g.set(e.name,e);k&&b.Map.setDefault(g,f)})};b.Map.dispose=function(b){b.dispose()}})(Lavaca.util,Lavaca.$,Lavaca.util.Disposable);
(function(b,h,j){function g(c,a,d){d&&(d=JSON.parse(d));return new b.Config(c,a,d)}var f=new b.Cache;b.Config=j.extend({});b.Config.setDefault=function(c){j.setDefault(f,c)};b.Config.currentEnvironment=function(){return f.get("default").name};b.Config.get=function(c,a){return j.get(f,c,a,"default")};b.Config.init=function(c){j.init(f,"text/x-config",g,c)};b.Config.dispose=function(){j.dispose(f)}})(Lavaca.util,Lavaca.$,Lavaca.util.Map);
(function(b){b.Promise=Lavaca.extend(function(b){this.thisp=b;this.resolvedQueue=[];this.rejectedQueue=[]},{succeeded:false,failed:false,success:function(b){b&&(this.succeeded?b.apply(this.thisp,this.resolveArgs):this.resolvedQueue.push(b));return this},error:function(b){b&&(this.failed?b.apply(this.thisp,this.rejectArgs):this.rejectedQueue.push(b));return this},always:function(b){return this.then(b,b)},then:function(b,j){return this.success(b).error(j)},resolve:function(){if(!this.succeeded&&!this.failed){this.succeeded=
true;this.resolveArgs=[].slice.call(arguments,0);for(var b=-1,j;j=this.resolvedQueue[++b];)j.apply(this.thisp,this.resolveArgs)}return this},reject:function(){if(!this.succeeded&&!this.failed){this.failed=true;this.rejectArgs=[].slice.call(arguments,0);for(var b=-1,j;j=this.rejectedQueue[++b];)j.apply(this.thisp,this.rejectArgs)}return this},when:function(){for(var b=this,j=[],g=-1,f=arguments.length,c;c=arguments[++g];)(function(a){c.success(function(d){j[a]=d;--f<1&&b.resolve.apply(b,j)}).error(function(){b.reject.apply(b,
arguments)})})(g);c=null;return this},resolver:function(){var b=this;return function(){b.resolve.apply(b,arguments)}},rejector:function(){var b=this;return function(){b.reject.apply(b,arguments)}}});b.Promise.when=function(h){var j=h instanceof b.Promise,g=new b.Promise(j?window:h),j=[].slice.call(arguments,j?0:1);return g.when.apply(g,j)}})(Lavaca.resolve("Lavaca.util",!0));
(function(b,h){function j(b){return b}var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};b.format=function(b){var c,a=j,d,e;if(arguments[1]instanceof Array){c=arguments[1];a=arguments[2]||j}else c=[].slice.call(arguments,1);d=0;for(e=c.length;d<e;d++)b=b.split("{"+d+"}").join(a(c[d]+""));return b};b.escapeHTML=function(b){var b=""+b,c;for(c in g)b=b.split(c).join(g[c]);return b};b.compress=function(b){typeof b!="string"&&(b=JSON.stringify(b));return(new h).compress(b)};b.decompress=
function(b){return(new h).decompress(b)}})(Lavaca.resolve("Lavaca.util.StringUtils",!0),window.LZ77);
(function(b,h){function j(f,c,a){a&&(a=JSON.parse(a));f=new b.Translation(f,c,a);g.get(f.language)||g.set(f.language,f);return f}var g=new b.Cache;b.Translation=h.extend(function(b,c,a){h.apply(this,arguments);var d=b=b.toLowerCase().split("_");this.language=d[0];this.locale=(this.country=d[1]||"")?this.language+"_"+this.country:this.language},{is:function(b,c){return b==this.language&&(!c||!this.country||c==this.country)}});b.Translation.setDefault=function(f){g.remove("default");h.setDefault(g,
b.Translation.forLocale(f))};b.Translation.forLocale=function(b){b=(b||"default").toLowerCase();return g.get(b)||g.get(b.split("_")[0])||g.get("default")};b.Translation.get=function(f,c){if(!c){c=f;f="default"}var a=b.Translation.forLocale(f),d=null;a&&(d=a.get(c));if(d===null)(a=b.Translation.forLocale(f.split("_")[0]))&&(d=a.get(c));if(d===null)(a=b.Translation.forLocale("default"))&&(d=a.get(c));return d};b.Translation.init=function(f,c){h.init(g,"text/x-translation",j,c);b.Translation.setDefault(f)};
b.Translation.dispose=function(){h.dispose(g)}})(Lavaca.util,Lavaca.util.Map);
(function(b,h){b.EventDispatcher=h.extend({suppressEvents:false,on:function(b,g,f){var c=this.callbacks||(this.callbacks={}),b=c[b]||(c[b]=[]);b[b.length]={fn:g,thisp:f};return this},off:function(b,g,f){var c=this.callbacks,a,d=-1,e,l;if(b){if(c)if(g){if(a=c[b])for(c=c[b]=[];b=a[++d];){e=b.fn==g||b.fn.fn==g;l=f&&(b.thisp==f||b.fn.thisp==f);if(!e||e&&(!f||!l))c[c.length]=b}}else delete c[b]}else delete this.callbacks;return this},trigger:function(b,g){if(!this.suppressEvents&&this.callbacks){var f=
this.callbacks[b],c=this.createEvent(b,g),a=-1,d;if(f)for(;d=f[++a];)d.fn.apply(d.thisp||this,[c])}return this},createEvent:function(b,g){return Lavaca.merge({},g||{},{type:b,target:g&&g.target?g.target:this,currentTarget:this})}})})(Lavaca.resolve("Lavaca.events",!0),Lavaca.util.Disposable);
(function(b){var h=["screenX","screenY","clientX","clientY","pageX","pageY"];b.EventPoint=Lavaca.extend(function(b){this.init(b)},{screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,init:function(b){for(var g=-1,f;f=h[++g];)this[f]=b?b[f]:null}})})(Lavaca.resolve("Lavaca.events",!0));(function(b){b.EventVector=Lavaca.extend(function(b,j,g){this.length=b;this.axis=j;this.compass=g},{length:0,axis:"vertical",compass:"north"})})(Lavaca.resolve("Lavaca.events",!0));
(function(b,h,j,g){function f(a,d){y[a]=function(a){d(a)}}function c(a,d){w[a]=function(a){d(a)}}function a(a,d){if(!a.touches&&a.originalEvent)a=a.originalEvent;a.touches&&a.touches.length?a=a.touches[d||0]:a.changedTouches&&a.changedTouches.length&&(a=a.changedTouches[d||0]);return new g(a)}function d(a,d){for(var c={},b=-1,e;e=r[++b];)c[e]=a[e]-d[e];return new g(c)}function e(a,d){return Math.sqrt((a.screenX-d.screenX)*(a.screenX-d.screenX)+(a.screenY-d.screenY)*(a.screenY-d.screenY))}function l(a,
d){var c=a.screenX-d.screenX,b=a.screenY-d.screenY;return c*c>b*b?new j(Math.abs(c),"horizontal",c>0?"east":"west"):new j(Math.abs(b),"vertical",b>0?"south":"north")}function k(a,d){var c=-1,b;if(null!==a&&d.changedTouches){for(;b=d.changedTouches[++c];)if(b.identifier===a)return b;return null}return d}function o(a){if(a){for(var d in a)typeof a[d]!="function"&&(this[d]=a[d]);this.originalEvent=a}}var q="mousedown",p="mousemove",n="mouseup",r=["screenX","screenY","clientX","clientY","pageX","pageY"],
s=false,y={},w={};(function(){var a=document.createElement("div");a.setAttribute("ontouchstart","return;");a.setAttribute("ongesturestart","return;");if(s=typeof a.ontouchstart=="function"){q="touchstart";p="touchmove";n="touchend"}})();(function(){h(document.body).on(p,function(a){for(var d in y)y[d](a)}).on(n,function(a){for(var d in w)w[d](a)})})();o.prototype={preventDefault:function(){this.defaultPrevented=true;this.originalEvent&&this.originalEvent.preventDefault()},stopPropagation:function(){this.originalEvent&&
this.originalEvent.stopPropagation()}};b.moveThreshold=4;b.tapholdDuration=800;b.isSupported=function(){return s};b.bind=function(g,h,j,p,n,r){function s(a){var c=new o(a);if(a){c.startTime=C;c.elapsed=(new Date).getTime()-C;c.startPoint=D;c.lastPoint=E;c.currentPoint=B;c.hasMoved=N||(N=!(e(D,B)<=b.moveThreshold));if(D&&B){c.startDelta=d(B,D);c.startDistance=e(B,D);c.startVector=l(B,D)}if(B&&E){c.lastDelta=d(B,E);c.lastDistance=e(B,E);c.lastVector=l(B,E)}}return c}if(typeof h=="function"){h={start:h,
move:j,end:p};r=n}if(h&&typeof h=="object"){r=j;j=h;h=null}if(j&&typeof j=="object"){p=j.move;n=j.end;j=j.start;r=p}var C,D,E,B,N=false,H=false,K,x={},F;x.click=function(a){H&&a.preventDefault()};x[q]=function(d){var d=d.originalEvent||d,b=this,e=Lavaca.uuid();C=(new Date).getTime();D=E=B=a(d);N=false;d.changedTouches&&d.changedTouches.length?K=d.changedTouches[0].identifier:idenfifier=null;j&&j.call(r||b,s(d));H=H||d.defaultPrevented;f(e,function(d){var c=k(K,d);if(null!==c){B=a(c);if(p){d=s(d);
d.currentTarget=b;p.call(r||b,d);H=H||d.defaultPrevented}E=B}});c(e,function(d){var c=k(K,d);if(null!==c){B=a(c);if(n){d=s(d);d.currentTarget=b;n.call(r||b,d);H=H||d.defaultPrevented}delete y[e];delete w[e];b=null}})};for(F in x)if(h)g.on(F,h,x[F]);else g.on(F,x[F]);g=null};h.fn.touch=function(a,d,c,e,f){if(a instanceof Function){f=e;e=c;c=d;d=a;a=null}b.bind(this,a,d,c,e,f);return this};h.fn.tap=function(a,d,c){if(typeof a=="function"){c=d;d=a;a=null}if(s)b.bind(this,a,null,null,function(a){!a.hasMoved&&
d&&d.apply(c||this,arguments)});else this.on("click",a,function(){d.apply(c||this,arguments)});return this};h.fn.taphold=function(a,d,c,e){if(typeof a=="function"){e=c;c=d;d=a;a=null}c=c||b.tapholdDuration;this.tap(a,function(a){a.elapsed>=c&&d&&d.apply(this,arguments)},e);return this};h.fn.swipe=function(a,d,c,e){if(typeof a=="function"){c=d;d=a;a=null}var c=c||{},f=c.minDistance||30,g=c.maxDistance||Number.MAX_VALUE,k=c.direction||"horizontal",l=c.timeLimit||1E3,h=c.cancel||null,j=c.move||null,
o=c.end||null;b.bind(this,a,c.start||null,function(a){a.elapsed<=l&&j&&j.apply(e||this,arguments)},function(a){o&&o.apply(e||this,arguments);a.elapsed<=l&&(k==a.startVector.compass||k==a.startVector.axis)&&a.startVector.length>=f&&a.startVector.length<=g?d&&d.apply(e||this,arguments):h&&h.apply(e||this,arguments)});return this}})(Lavaca.resolve("Lavaca.events.Touch",!0),Lavaca.$,Lavaca.events.EventVector,Lavaca.events.EventPoint);
(function(b,h,j){var g=false,f=[];b.isCordova=function(){return!!j};b.mobileBrowser=function(){var c={};c.agent=navigator.userAgent.toLowerCase();c.scrWidth=screen.width;c.scrHeight=screen.height;c.elemWidth=document.documentElement.clientWidth;c.elemHeight=document.documentElement.clientHeight;c.otherBrowser=c.agent.indexOf("series60")!=-1||c.agent.indexOf("symbian")!=-1||c.agent.indexOf("windows ce")!=-1||c.agent.indexOf("blackberry")!=-1;c.mobileOS=typeof orientation!="undefined"?true:false;c.touchOS=
"ontouchstart"in document.documentElement?true:false;c.blackberry=c.agent.indexOf("blackberry")>-1;c.ipad=c.agent.indexOf("ipad")!=-1?true:false;c.ipod=c.agent.indexOf("ipod")!=-1?true:false;c.iphone=c.agent.indexOf("iphone")!=-1?true:false;c.palm=c.agent.indexOf("palm")!=-1?true:false;c.symbian=c.agent.indexOf("symbian")!=-1?true:false;c.iOS=c.iphone||c.ipod||c.ipad?true:false;c.android=c.agent.indexOf("android")!=-1||!c.iOS&&!c.otherBrowser&&c.touchOS&&c.mobileOS?true:false;c.android2=c.android&&
c.agent.indexOf("android 2")!=-1?true:false;c.isMobile=c.android||c.iOS||c.mobileOS||c.touchOS?true:false;return c};b.register=function(c,a){function d(){if(!window.plugins)window.plugins={};window.plugins[c]=new a}g?d():f.push(d)};b.exec=function(c,a,d){var b=new Lavaca.util.Promise(window);j?j.exec(b.resolver(),b.rejector(),c,a,d):b.reject();return b};b.init=function(c){if(document.addEventListener)document.addEventListener("deviceready",c,false);else h(document).on("deviceready",c)};h(document).ready(function(){for(var c=
-1,a;a=f[++c];)a();g=true;if(!j)if(document.createEvent){c=document.createEvent("Events");c.initEvent("deviceready",true,false);document.dispatchEvent(c)}else if(document.fireEvent){c=document.createEventObject();c.eventType="deviceready";document.fireEvent("ondeviceready",c)}})})(Lavaca.resolve("Lavaca.env.Device",!0),Lavaca.$,window.Cordova||window.cordova);
(function(b,h){b.Badge=Lavaca.events.EventDispatcher.extend({get:function(){return h.exec("Badge","get")},set:function(b){var g=this;return h.exec("Badge","set",[b]).success(function(b){g.trigger("change",{count:b})})},increment:function(b){var b=b||1,g=this,f=new Lavaca.util.Promise;this.get().success(function(c){g.set(c+b).success(f.resolver()).error(f.rejector())}).error(f.rejector());return f},decrement:function(b){return self.increment(-(b||1))},clear:function(){return this.set(0)}});h.register("badge",
b.Badge)})(Lavaca.env,Lavaca.env.Device);(function(b,h){b.ChildBrowser=Lavaca.events.EventDispatcher.extend({showWebPage:function(b){if(h.isCordova())return h.exec("ChildBrowser","showWebPage",[b]).error(function(){window.location.href=b});window.open(b);return(new Lavaca.util.Promise(window)).resolve()},close:function(){return h.exec("ChildBrowser","close",[])}});h.register("childBrowser",b.ChildBrowser)})(Lavaca.env,Lavaca.env.Device);
(function(b,h,j){function g(c,a,d,b,g){if(d===f){d=a;a=""}b||(b=[]);var b=[].concat(b),k=-1,h=b.length,d=[d,function(a){c=="confirm"&&(a===f||a===h||h===0&&a==2)?g.reject((h||2)-1):g.resolve(a-1)},a],j=[];for(c=="confirm"&&b.push(b.shift());a=b[++k];){j.push(a.name);if(a.exec)g[c=="confirm"&&k==b.length-1?"error":"success"](function(a,d){return function(c){c===f&&(c=h);c==a&&d(a)}}(k,a.exec))}d.push(j.join(","));navigator.notification[c].apply(navigator.notification,d)}var f;b.Notification=Lavaca.events.EventDispatcher.extend({alert:function(c,
a,d){var b=new j;if(h.isCordova())g("alert",c,a,d,b);else if(window.alert){(button=(d||[])[0])&&button.exec&&b.then(button.exec);alert(a||c);b.resolve(0)}else b.reject();return b},confirm:function(c,a,d){var b=new j;if(h.isCordova())g("confirm",c,a,d,b);else if(window.confirm){d&&b.success((d[1]||{}).exec).error((d[0]||{}).exec);confirm(a)?b.resolve(1):b.reject(0)}else b.reject();return b}});h.register("notification",b.Notification)})(Lavaca.env,Lavaca.env.Device,Lavaca.util.Promise);
(function(b,h){var j={animation:["animation","animationend","keyframes"],webkitAnimation:["-webkit-animation","webkitAnimationEnd","-webkit-keyframes"],MozAnimation:["-moz-animation","animationend","-moz-keyframes"],OAnimation:["-o-animation","oAnimationEnd","-o-keyframes"],MSAnimation:["-ms-animation","MSAnimationEnd","-ms-keyframes"]},g,f,c,a;(function(){var d=document.createElement("div").style,b;for(b in j)if(b in d){d=j[b];g=b;f=d[0];a=d[1];c=d[2];break}})();b.isSupported=function(){return!!g};
b.keyframesToCSS=function(a,b){var f=Lavaca.fx.Transform,g=["@",c," ",a,"{"],h,j,p,n;for(h in b){g.push(h,"{");j=b[h];if(typeof j=="string")g.push(j);else for(p in j){n=j[p];if(p=="transform"&&f){p=f.cssProperty();n=f.toCSS(n)}g.push(p,":",n,";")}g.push("}")}g.push("}");return g.join("")};b.generateKeyframes=function(a,c){if(typeof a=="object"){c=a;a="a"+(new Date).getTime()}var f=b.keyframesToCSS(a,c);h("<style>"+f+"</style>").appendTo("head");return a};b.cssProperty=function(){return f};h.fn.keyframe=
function(a,c,f,g,h,j,p){if(b.isSupported()){typeof a=="object"&&(a=b.generateKeyframes(a));if(typeof c=="object"){p=c.complete;j=c.direction;h=c.iterations;g=c.delay;f=c.easing;c=c.duration}j=j||"normal";h=h||1;g=g||0;f=f||"linear";c=c||1;typeof c=="number"&&(c=c+"ms");typeof g=="number"&&(g=g+"ms");p&&this.nextAnimationEnd(p);this.css(b.cssProperty(),[a,c,f,g,h,j].join(" "))}return this};h.fn.animationEnd=function(d,c){return a?this.on(a,d,c):this};h.fn.nextAnimationEnd=function(d,c){return a?this.one(a,
d,c):this}})(Lavaca.resolve("Lavaca.fx.Animation",!0),Lavaca.$);
(function(b,h){function j(a,c){var b=a.indexOf("rotate")==0,f=a=="scale",g=a.indexOf("translate")==0;/(X|Y|Z)$/.test(a);var h,j=[];if(typeof c=="object")for(h in c)j.push(a+h.toUpperCase()+"("+(g?typeof c[h]=="number"?c[h]+"px":c[h]:b?typeof c[h]=="number"?c[h]+"deg":c[h]:f?typeof c[h]=="number"?c[h]+","+c[h]:c[h]:c[h])+")");else{f?c=typeof c=="number"?c+","+c:c:b?c=typeof c=="number"?c+"deg":c:g&&(c=typeof c=="number"?c+"px":c);j.push(a+"("+c+")")}return j.join(" ")}var g={transform:"transform",
webkitTransform:"-webkit-transform",MozTransform:"-moz-transform",OTransform:"-o-transform",MSTransform:"-ms-transform"},f,c,a=false;(function(){var d=document.createElement("div").style,b;for(b in g)if(b in d){f=b;c=g[b];d[b]="translate3d(0,0,0)";a=d[b].indexOf("translate3d")>-1&&navigator.userAgent.indexOf("Android")==-1;break}})();b.isSupported=function(){return!!f};b.is3dSupported=function(){return a};b.toCSS=function(a){var c=[],b;if(typeof a=="object")for(b in a)c.push(j(b,a[b]));else c.push(a);
return c.join(" ")};b.cssProperty=function(){return c};h.fn.transform=function(a,c){if(b.isSupported()){a=b.toCSS(a);c&&typeof c=="object"&&(c=(typeof c.x=="number"?c.x*100+"%":c.x)+(c.y===void 0?"":" "+(typeof c.y=="number"?c.y*100+"%":c.y)));this.each(function(){this.style[f]=a;c&&(this.style[f+"Origin"]=c)})}return this}})(Lavaca.resolve("Lavaca.fx.Transform",!0),Lavaca.$);
(function(b,h){var j={transition:["transition","transitionend"],webkitTransition:["-webkit-transition","webkitTransitionEnd"],MozTransition:["-moz-transition","MozTransitionEnd"],OTransition:["-o-transition","OTransitionEnd"],MSTransition:["-ms-transition","MSTransitionEnd"]},g,f,c;(function(){var a=document.createElement("div").style,d;for(d in j)if(d in a){g=d;f=j[d][0];c=j[d][1];break}})();b.isSupported=function(){return!!g};b.toCSS=function(a,c,b){var b=b||"linear",f=[],g=a instanceof Array,h;
for(h in a){g&&(h=a[h]);f.push(h+" "+c+"ms "+b)}return f.join(",")};b.cssProperty=function(){return f};h.fn.transition=function(a,c,e,f){if(e instanceof Function){f=e;e=null}if(b.isSupported()){var h=b.toCSS(a,c,e);f&&this.nextTransitionEnd(f);this.each(function(){this.style[g]=h});this.css(a)}else{this.css(a);f&&f.call(this[0],{})}return this};h.fn.transitionEnd=function(a,d){return c?this.on(c,a,d):this};h.fn.nextTransitionEnd=function(a,d){return c?this.one(c,a,d):this}})(Lavaca.resolve("Lavaca.fx.Transition",
!0),Lavaca.$);
(function(b,h,j,g){b.Controller=h.extend(function(f,c){if(f instanceof b.Controller){this.router=f.router;this.viewManager=f.viewManager}else{this.router=f;this.viewManager=c}},{router:null,viewManager:null,exec:function(b,c,a){this.params=c;this.state=a;var d=new j(this),e;if(a){e=a.state;d.success(function(){document.title=a.title})}b=this[b](c,e);b instanceof j?d.when(b):d.resolve();return d},ajax:function(b){return j.when(this,Lavaca.net.Connectivity.ajax(b))},view:function(b,c,a,d){return j.when(this,
this.viewManager.load(b,c,a,d))},ajaxThenView:function(b,c,a,d,e){var g=new j(this),h=this;this.ajax(b).success(function(b){g.when(this.view(a,d,c.apply(h,arguments),e))}).error(function(){g.reject.apply(g,arguments)});return g},history:function(b,c,a,d){var e=!this.state;return function(){if(e)Lavaca.net.History[d?"replace":"push"](b,c,a)}},translate:function(b,c){var a=Lavaca.util.Translation.get(b);a&&c&&(a=g.format.apply(null,[a].concat(c)));return a},url:function(b,c){return g.format(b,c,encodeURIComponent)},
redirect:function(b,c){return this.router.unlock().exec(this.url(b,c||[]))},ajaxThenRedirect:function(b,c){var a=new j(this),d=this;this.ajax(b).success(function(b){a.when(this.redirect(c.apply(d,arguments)))}).error(function(){a.reject.apply(a,arguments)});return a},dispose:function(){this.router=this.viewManager=null;h.prototype.dispose.apply(this,arguments)}})})(Lavaca.resolve("Lavaca.mvc",!0),Lavaca.util.Disposable,Lavaca.util.Promise,Lavaca.util.StringUtils,Lavaca.$);
(function(b,h,j,g,f){function c(a,c,d,b,f,g){a.trigger(c,{attribute:d,previous:b===e?null:b,value:f===e?a.get(d):f,messages:g||[]})}function a(a,c,d){for(var c=!!c,b=["suppressValidation","suppressEvents","suppressTracking"],e={},f=-1,g;g=b[++f];){e[g]=a[g];a[g]=c||a[g]}c=d.call(a);for(f=-1;g=b[++f];)a[g]=e[g];return c}function d(a){var c=true,d;for(d in a)a[d].length>0&&(c=false);a.isValid=c;return a}var e;b.Model=h.extend(function(a){h.call(this);this.attributes=new j;this.rules=new j;this.unsavedAttributes=
[];this.flags={};this.defaults&&(a=Lavaca.merge({},this.defaults,a));if(a){this.suppressEvents=this.suppressTracking=true;this.apply(a);this.suppressEvents=this.suppressTracking=false}},{suppressValidation:false,suppressTracking:false,get:function(a){a=this.attributes.get(a);return typeof a==="function"?a.call(this):a},canSet:function(){return true},set:function(d,b,e,g){return a(this,g,function(){if(!this.canSet(d))return false;var a=this.attributes.get(d),g=this.suppressValidation?[]:this.validate(d,
b);if(g.length){c(this,"invalid",d,a,b,g);return false}if(a!==b){this.attributes.set(d,b);if(e){(g=this.flags[e])||(g=this.flags[e]=[]);f.contains(g,d)||g.push(d)}c(this,"change",d,a,b);!this.suppressTracking&&!Lavaca.util.ArrayUtils.contains(this.unsavedAttributes,d)&&this.unsavedAttributes.push(d)}return true})},has:function(a){return this.get(a)!==null},idAttribute:"id",id:function(){return this.get(this.idAttribute)},isNew:function(){return null===this.id()},parse:function(a){typeof a=="string"&&
(a=JSON.parse(a));return a},apply:function(c,d){a(this,d,function(){c=this.parse(c);for(var a in c)this.set(a,c[a])})},clear:function(a){if(a){var a=this.flags[a],c=-1,d,b;if(a)for(;d=a[++c];){f.remove(this.unsavedAttributes,d);(b=this.get(d))&&b.dispose&&b.dispose();this.set(d,null)}}else{this.attributes.dispose();this.attributes=new j;this.unsavedAttributes.length=0}},clone:function(){return new this.constructor(this.attributes.toObject())},addRule:function(a,c,d){this.rules.get(a,[]).push({rule:c,
message:d})},validate:function(a,c){var b,f,g=-1,h;if(a){b=[];c=c===e?this.get(a,c):c;if(f=this.rules.get(a))for(;h=f[++g];)h.rule(a,c)||b.push(h.message);return b}b={};this.rules.each(function(a){b[a]=this.validate(a)},this);return d(b)},onFetchSuccess:function(a){a=this.parse(a);this.apply(a,true);this.trigger("fetchSuccess",{response:a})},onFetchError:function(a){this.trigger("fetchError",{response:a})},fetch:function(a,c){c=Lavaca.clone(c||{});c.url=a;return g.when(this,Lavaca.net.Connectivity.ajax(c)).success(this.onFetchSuccess).error(this.onFetchError)},
save:function(a,c){for(var d=new g(this),b=this.toObject(),f={},h=-1,j;j=this.unsavedAttributes[++h];)f[j]=b[j];d.success(function(a){var c=this.idAttribute;this.isNew()&&a[c]!==e&&this.set(c,a[c]);this.unsavedAttributes=[];this.trigger("saveSuccess",{response:a})}).error(function(a){this.trigger("saveError",{response:a})});b=a.call(c||this,this,f,b);b instanceof g?d.when(b):b?d.resolve(b):d.reject(b);return d},saveToServer:function(a){return this.save(function(c,d,b){c=this.id();this.isNew()?d=b:
d[this.idAttribute]=c;return g.when(this,Lavaca.net.Connectivity.ajax({url:a,cache:false,type:"POST",data:d,dataType:"json"}))})},toObject:function(){var a=this.attributes.toObject(),c;for(c in a)typeof a[c]==="function"&&(a[c]=a[c].call(this));return a},toJSON:function(){return JSON.stringify(this.toObject())},on:function(a,c,d,b){function e(a){if(!c||a.attribute==c)d.call(b||this,a)}if(typeof c=="function"){b=d;d=c;c=null}e.fn=d;e.thisp=b;return h.prototype.on.call(this,a,e,b)}});b.Model.SENSITIVE=
"sensitive"})(Lavaca.resolve("Lavaca.mvc",!0),Lavaca.events.EventDispatcher,Lavaca.util.Cache,Lavaca.util.Promise,Lavaca.util.ArrayUtils);
(function(b,h,j,g,f){function c(a,c,b,f,g){a.trigger(c,{previousIndex:b,index:f,model:g})}function a(a,c){var b=c?1:-1;return function(c,e){var f=c.get(a),g=e.get(a);return f==g?0:f<g?b:-b}}b.Collection=h.extend(function(a,c){h.call(this,c);this.models=[];this.changedOrder=false;this.addedItems=[];this.removedItems=[];this.changedItems=[];if(a){this.suppressEvents=true;this.add.apply(this,a);this.suppressEvents=false}},{TModel:b.Model,itemsProperty:"items",clear:function(){h.prototype.clear.apply(this,
arguments);for(var a=-1,c;c=this.models[++a];)this.remove(c);this.changedOrder=false;this.addedItems.length=this.removedItems.length=this.changedItems.length=this.models.length=0},prepare:function(a){a=a instanceof this.TModel?a:this.TModel.prototype instanceof b.Collection?new this.TModel(a[this.TModel.prototype.itemsProperty],a):new this.TModel(a);if(f.indexOf(this.models,a)==-1)a.on("change",this.onItemEvent,this).on("invalid",this.onItemEvent,this).on("saveSuccess",this.onItemEvent,this).on("saveError",
this.onItemEvent,this);return a},canSet:function(a){return a!=this.itemsProperty},add:function(){if(arguments.length&&arguments[0]instanceof Array)return this.add.apply(this,arguments[0]);var a=false,b,g,h,j,q;g=0;for(h=arguments.length;g<h;g++){j=arguments[g];(q=j instanceof this.TModel)||(b=j);j=this.prepare(j);q=this.first(b||j.toObject());if(!q){this.models.push(j);if(!this.suppressTracking){f.remove(this.removedItems,j);f.remove(this.changedItems,j);f.pushIfNotExists(this.addedItems,j)}c(this,
"addItem",null,this.models.length-1,j);a=true}}return a},moveTo:function(a,b){a instanceof this.TModel&&(a=f.indexOf(this.models,a));if(a>-1){var g=this.models.splice(a,1)[0];if(g){this.models.splice(b,0,g);if(!this.suppressTracking)this.changedOrder=true;c(this,"moveItem",a,b,g)}}},remove:function(a){if(a instanceof this.TModel){var b=f.remove(this.models,a);if(b>-1){if(!this.suppressTracking){f.remove(this.addedItems,a);f.remove(this.changedItems,a);f.pushIfNotExists(this.removedItems,a)}a.off("change",
this.onItemEvent).off("invalid",this.onItemEvent).off("saveSuccess",this.onItemEvent).off("saveError",this.onItemEvent);c(this,"removeItem",b,null,a);return true}return false}for(var b=this.filter(a),g=-1,h=false;a=b[++g];)h=this.remove(a)||h;return h},filter:function(a,c){var c=c===void 0?Number.MAX_VALUE:c,b=[],f=-1,g,h,j;if(typeof a!="function"){h=a;a=function(a,c){for(j in h)if(c.get(j)!=h[j])return false;return true}}for(;g=this.models[++f];)if(a(f,g)){b.push(g);if(--c<1)break}return b},first:function(a){return this.filter(a,
1)[0]||null},itemAt:function(a){return this.models[a]},count:function(){return this.models.length},each:function(a,c){for(var b=-1,f;f=this.itemAt(++b);)a.call(c||this,b,f)},sort:function(c,b){var f=typeof c==="function"?c:a(c,b),g=Lavaca.clone(this.models);this.models.sort(f,this);if(!this.suppressTracking)this.changedOrder=true;this.trigger("rearrange",{oldModels:g,newModels:this.models});return this},reverse:function(){var a=Lavaca.clone(this.models);this.models.reverse();if(!this.suppressTracking)this.changedOrder=
true;this.trigger("rearrange",{oldModels:a,newModels:this.models});return this},onItemEvent:function(a){var c=a.target,b=f.indexOf(this.models,c);a.type=="change"?f.pushIfNotExists(this.changedItems,c):a.type=="saveSuccess"&&f.remove(this.changedItems,c);this.trigger(a.type+"Item",Lavaca.merge({},a,{target:c,model:c,index:b,previousIndex:null}))},onFetchSuccess:function(a){var c=a=this.parse(a);if(!(c instanceof Array)){this.apply(a);c=a[this.itemsProperty]}this.add.apply(this,c);this.trigger("fetchSuccess",
{response:a})},saveToServer:function(a){return this.save(function(c,b,f){c=this.id();this.isNew()?b=f:b[this.idAttribute]=c;return(new g(this)).when(Lavaca.net.Connectivity.ajax({url:a,cache:false,type:"POST",data:b,dataType:"json"}))})},toObject:function(a){for(var c=h.prototype.toObject.apply(this,arguments),b=this.itemsProperty,f=c[b]=[],g=-1,j;j=this.models[++g];)f[c[b].length]=a&&!j.isNew()?j.id():j.toObject();return c}})})(Lavaca.mvc,Lavaca.mvc.Model,Lavaca.util.Cache,Lavaca.util.Promise,Lavaca.util.ArrayUtils);
(function(b,h){function j(){return RegExp("\\{\\*(.*?)\\}","g")}function g(b){b=decodeURIComponent(b);if(isNaN(b))if(b.toLowerCase()=="true")b=true;else if(b.toLowerCase()=="false")b=false;else{if(RegExp("^\\d{4}-[0-1]\\d-[0-3]\\d$","g").test(b)){b=b.split("-");b=new Date(Number(b[0]),Number(b[1])-1,Number(b[2]))}}else b=Number(b);return b}b.Route=h.extend(function(b,c,a,d){h.call(this);this.pattern=b;this.TController=c;this.action=a;this.params=d||{}},{matches:function(b){var c;c=this.pattern;if(c==
"/")c=RegExp("^\\/(\\?.*)?(#.*)?$","g");else{c.charAt(0)=="/"&&(c=c.slice(1));c=c.split("/");for(var a="^",d=-1,e;e=c[++d];)a=j().test(e)?a+"(/([^/?#]+))*?":RegExp("\\{([^\\/]*?)\\}","g").test(e)?a+"/([^/?#]+)":a+("/"+e);c=RegExp(a+"(\\?.*)?(#.*)?$","g")}return c.test(b)},parse:function(b){var c=Lavaca.clone(this.params),a=this.pattern.slice(1),d=b.split("#"),e,h,k;c.url=b;c.route=this;d=d[1]?d[1].split("?"):d[0].split("?");if(e=d[1]){b=-1;for(e=e.split("&");h=e[++b];){h=h.split("=");k=decodeURIComponent(h[0]);
if(c[k]!==void 0){c[k]instanceof Array||(c[k]=[c[k]]);c[k].push(g(h[1]))}else c[k]=g(h[1])}}b=0;d=d[0].replace(/(^(http(s?)\:\/\/[^\/]+)?\/?)|(\/$)/,"");h=RegExp(a.replace(j(),"(.+)").replace(RegExp("\\{([^\\/]*?)\\}","g"),"([^/]+)"));d=h.exec(d);for(e=h.exec(a);h=d[++b];){a=e[b];j().test(a)&&(h=h.split("/"));c[a.replace(RegExp("[\\{\\}\\*]","g"),"")]=h}return c},exec:function(b,c,a,d,e){function g(){Lavaca.delay(h.dispose,h)}var h=new this.TController(c,a),b=this.parse(b),d=h.exec(this.action,Lavaca.merge(b,
e),d);d.then(g,g);return d}})})(Lavaca.resolve("Lavaca.mvc",!0),Lavaca.util.Disposable);
(function(b,h,j){b.Router=h.extend(function(b){h.call(this);this.routes=[];this.viewManager=b;this.onpopstate=function(b){this.hasNavigated&&this.exec(b.url,b)};Lavaca.net.History.on("popstate",this.onpopstate,this)},{locked:false,hasNavigated:false,add:function(g,f,c,a){if(typeof g=="object")for(var d in g){a=g[d];if(a instanceof Array){f=a[0];c=a[1];a=a[2]}else{f=a.controller;c=a.action;a=a.params}this.add(d,f,c,a)}else this.routes.push(new b.Route(g,f,c,a));return this},exec:function(b,f,c){if(this.locked)return(new j(this)).reject("locked");
this.locked=true;b||(b="/");b.indexOf("http")==0&&(b=b.replace(/^http(s?):\/\/.+?/,""));var a=-1,d,e=new j(this);e.always(function(){this.unlock()});for(this.hasNavigated||e.success(function(){this.hasNavigated=true});d=this.routes[++a];)if(d.matches(b))return e.when(d.exec(b,this,this.viewManager,f,c));return e.reject(b,f)},unlock:function(){this.locked=false;return this},dispose:function(){if(this.onpopstate){Lavaca.net.History.off("popstate",this.onpopstate);this.onpopstate=null}h.prototype.dispose.apply(this,
arguments)}})})(Lavaca.resolve("Lavaca.mvc",!0),Lavaca.util.Disposable,Lavaca.util.Promise);
(function(b,h,j,g){b.View=j.extend(function(b,c,a,d){j.call(this);this.model=b||null;this.layer=c||0;this.eventMap=a||{};this.widgetMap=d||{};this.widgets=new Lavaca.util.Cache;this.on("rendersuccess",this.onRenderSuccess).on("rendererror",this.onRenderError)},{el:null,shell:null,template:null,className:null,wrapper:function(){return h('<div class="view"></div>')},interior:function(){return h('<div class="view-interior"></div>')},render:function(){var f=new g(this),c=Lavaca.ui.Template.get(this.template),
a=this.model;a instanceof b.Model&&(a=a.toObject());this.el&&this.el.detach();this.shell=this.wrapper();this.el=this.interior();this.shell.append(this.el);this.shell.attr("data-layer-index",this.layer);this.className&&this.shell.addClass(this.className);f.success(function(a){this.trigger("rendersuccess",{html:a})}).error(function(a){this.trigger("rendererror",{err:a})});this.shell.addClass("tmpl-"+this.template.toLowerCase().replace(/\s/g,"-"));c.render(a).success(f.resolver()).error(f.rejector());
return f},redraw:function(f,c){var a=new g(this),d=new g(this),e=Lavaca.ui.Template.get(this.template),j;if(typeof f==="object"||f instanceof b.Model){c=f;j=true;f=null}else if(typeof f=="boolean"){j=f;f=null}else f||(j=true);if(!this.hasRendered)return d.rejector("View has not been rendered yet and cannot be redrawn.");c=c||this.model;c instanceof b.Model&&(c=c.toObject());a.success(function(a){if(j){this.el.html(a);d.resolve(a)}else if(f){var c=h("<div>"+a+"</div>").find(f),b=this.el.find(f);if(c.length>
0&&c.length===b.length){b.each(function(a){h(this).replaceWith(c.eq(a))});d.resolve(a)}else d.reject("Count of items matching selector is not the same in the original html and in the newly rendered html.")}else d.resolve(a)}).error(d.rejector());e.render(c).success(a.resolver()).error(a.rejector());return d},clearModelEvents:function(){var b,c;if(this.eventMap&&this.eventMap.model&&this.model&&this.model instanceof j)for(b in this.eventMap.model){c=this.eventMap.model[b];if(typeof c=="object")c=c.on;
this.model.off(b,c,this)}},applyEvents:function(){var b=this.el,c,a,d,e,g;for(d in this.eventMap){c=this.eventMap[d];for(e in c){a=c[e];if(typeof a=="object"){g=a;a=a.on}else g=void 0;if(d=="model"){if(this.model&&this.model instanceof j)this.model.on(e,a,this)}else if(e=="tap"&&b.tap)b.tap(d,a);else if(e=="taphold"&&b.taphold)b.taphold(d,a,g?g.duration:void 0);else if(e=="swipe"&&b.swipe)b.swipe(d,a,g);else if(e=="animationEnd"&&b.animationEnd)b.animationEnd(d,a);else if(e=="transitionEnd"&&b.transitionEnd)b.transitionEnd(d,
a);else b.on(e,d,a)}}},mapEvent:function(b,c,a){var d;if(typeof b=="object"){d=b;for(b in d)for(c in d[b])this.mapEvent(b,c,d[b][c])}else{(d=this.eventMap[b])||(d=this.eventMap[b]={});d[c]=a}return this},createWidgets:function(){var b=this.widgets,c,a,d;for(a in this.widgetMap){d=this.widgetMap[a];(a=="self"?this.el:this.el.find(a)).each(function(a,g){c=new d(h(g));b.set(c.id,c)})}},mapWidget:function(b,c){if(typeof b=="object"){var a=b;for(b in a)this.mapWidget(b,a[b])}else this.widgetMap[b]=c;return this},
insertInto:function(b){if(!this.shell.parent()[0]!=b[0]){for(var c=b.children("[data-layer-index]"),a=-1,d;d=c[++a];){d=h(d);if(d.attr("data-layer-index")>this.index){this.shell.insertBefore(d);return}}b.append(this.shell)}},enter:function(b){var c=new g(this),a,b=h(b);this.hasRendered||(a=this.render().error(c.rejector()));this.insertInto(b);a?c.when(a):Lavaca.delay(c.resolver());c.then(function(){this.trigger("enter")});return c},exit:function(){var b=new g(this);this.shell.detach();Lavaca.delay(b.resolver());
b.then(function(){this.trigger("exit")});return b},onRenderSuccess:function(b){this.el.html(b.html);this.applyEvents(this.el);this.createWidgets(this.el);this.hasRendered=true},onRenderError:function(b){Lavaca.log(b.err)},dispose:function(){this.model&&this.clearModelEvents();this.template=this.model=null;j.prototype.dispose.apply(this,arguments)}})})(Lavaca.resolve("Lavaca.mvc",!0),Lavaca.$,Lavaca.events.EventDispatcher,Lavaca.util.Promise);
(function(b,h,j,g,f,c){b.ViewManager=f.extend(function(a){f.call(this);this.el=j(a||document.body);this.views=new h.Cache;this.layers=[];this.exitingViews=[];this.enteringViews=[]},{locked:false,load:function(a,c,b,f){function h(){j.enteringViews=[q];p.success(function(){Lavaca.delay(function(){j.enteringViews=[]})});s=j.dismissLayersAbove(f-1,q);if(j.layers[f]!=q){n.when(q.enter(j.el,j.exitingViews),s).then(p.resolve);j.layers[f]=q}else p.when(s)}if(this.locked)return(new g(this)).reject("locked");
this.locked=true;var f=f||0,j=this,q=this.views.get(a),p=new g(this),n=new g(p),r=null,s=null;p.always(function(){this.locked=false});if(!q){q=new c(b,f);r=q.render();if(a!==null){this.views.set(a,q);q.cacheKey=a}}r?r.then(h,p.rejector()):h();return p},dismiss:function(a){if(typeof a=="number")this.dismissLayersAbove(a-1);else if(a instanceof Lavaca.mvc.View)this.dismiss(a.layer);else{var a=j(a),c=a.attr("data-layer-index");if(c===null){a=a.closest("[data-layer-index]");c=a.attr("data-layer-index")}c!==
null&&this.dismiss(Number(c))}},dismissLayersAbove:function(a,b){var e=new g(this),f=false,h,j;for(h=this.layers.length-1;h>a;h--)if((j=this.layers[h])&&(!b||b!=j)){(function(a){this.exitingViews.push(a);e.when(a.exit(this.el,this.enteringViews)).success(function(){Lavaca.delay(function(){c.remove(this.exitingViews,a);(!a.cacheKey||b&&b.cacheKey==a.cacheKey)&&a.dispose()},this)});this.layers[h]=null}).call(this,j);f=true}f||e.resolve();return e},flush:function(a){if(a)this.views.remove(a);else{for(var a=
-1,c;c=this.layers[++a];)c.cacheKey&&this.views.remove(c.cacheKey);this.views.dispose();this.views=new h.Cache}},dispose:function(){f.prototype.dispose.call(this)}})})(Lavaca.resolve("Lavaca.mvc",!0),Lavaca.util,Lavaca.$,Lavaca.util.Promise,Lavaca.util.Disposable,Lavaca.util.ArrayUtils);
(function(b,h,j){function g(b){b.preventDefault();b.stopPropagation()}b.Application=h.extend(function(b){Lavaca.env.Device.init(j.proxy(this.init,this));j(window).on("unload",j.proxy(this.dispose,this));if(b)this.on("init",b)},{TViewManager:Lavaca.mvc.ViewManager,TRouter:Lavaca.mvc.Router,TState:Lavaca.mvc.Model,initRoute:"/",initState:null,initParams:null,initLocale:"en_US",viewRootSelector:"#view-root",onInvalidRoute:function(b){b!="locked"&&plugins.notification.alert("An error occurred while trying to display this URL.")},
onTapLink:function(b){var c=j(b.currentTarget),a=c.attr("href"),d=c.attr("rel"),e=c.attr("target"),g=c.is("[data-external]");if(/^((mailto)|(tel)|(sms))\:/.test(a)){location.href=a;return true}b.preventDefault();if(d=="back")Lavaca.net.History.back();else if(g||d=="nofollow"||e=="_blank"){b.stopPropagation();plugins.childBrowser.showWebPage(a)}else d=="cancel"?this.viewManager.dismiss(b.currentTarget):a&&this.router.exec(a,null,c.dataAttrs()).error(this.onInvalidRoute)},ajax:function(){return Lavaca.net.Connectivity.ajax.apply(Lavaca.net.Connectivity,
arguments)},init:function(){var b=new Lavaca.util.Promise(this);this.mobileBrowser=Lavaca.env.Device.mobileBrowser();this.animations=!this.mobileBrowser.android;this.state=new this.TState;Lavaca.util.Config.init();this.state.set("lang",localStorage.getItem("app:lang")||this.initLocale);Lavaca.util.Translation.init(app.state.get("lang"));Lavaca.ui.Template.init();this.viewManager=new this.TViewManager(this.viewRootSelector);this.router=new this.TRouter(this.viewManager);j(document.body).tap("a",this.onTapLink,
this).tap(".ui-blocker",g);this.trigger("init");if(this.router.hasNavigated)b.resolve();else{b.when(this.router.exec(this.initialHashRoute||this.initRoute,this.initState,this.initParams));this.initState&&Lavaca.net.History.replace(this.initState.state,this.initState.title,this.initState.url)}return b.then(function(){this.trigger("ready")})},dispose:function(){this.trigger("dispose");Lavaca.util.Config.dispose();Lavaca.util.Translation.dispose();Lavaca.ui.Template.dispose();h.prototype.dispose.call(this)},
initialHashRoute:function(b){b=b.match(/^(?:#)(\/.*)#?@?/);return b instanceof Array&&b[1]?b[1].replace(/#.*/,""):null}(window.location.hash)})})(Lavaca.mvc,Lavaca.events.EventDispatcher,Lavaca.$);(function(b,h){function j(){throw"Not implemented";}b.Store=h.extend(function(b){this.id=b},{get:function(){j()},set:function(){j()},remove:function(){j()},all:function(){j()}})})(Lavaca.resolve("Lavaca.storage",!0),Lavaca.util.Disposable);
(function(b,h,j){function g(b){localStorage.setItem(b.id+"@manifest",JSON.stringify(b.manifest))}b.LocalStore=b.Store.extend(function(f){b.Store.call(this,f);this.manifest=JSON.parse(localStorage.getItem(this.id+"@manifest")||"[]")},{key:function(b){return this.id+":"+b},get:function(b){return(b=localStorage.getItem(this.key(b)))?JSON.parse(h.decompress(b)):null},set:function(b,c){localStorage.setItem(this.key(b),h.compress(JSON.stringify(c)));j.pushIfNotExists(this.manifest,b);g(this)},remove:function(b){localStorage.removeItem(this.key(b));
j.remove(this.manifest,b);g(this)},all:function(){for(var b=[],c=-1,a;a=this.manifest[++c];)b.push(this.get(a));return b}})})(Lavaca.resolve("Lavaca.storage"),Lavaca.util.StringUtils,Lavaca.util.ArrayUtils);
(function(b,h){function j(a){if(a==c)for(var b=-1,e;e=f[++b];)e(a)}var g=typeof navigator.onLine=="boolean",f=[],c="offline";navigator.userAgent.indexOf("Android");b.isOffline=function(){var a=Lavaca.resolve("navigator.connection.type");return a!==null?a==Lavaca.resolve("Connection.NONE"):g?!navigator.onLine:false};b.ajax=function(a){var d=new Lavaca.util.Promise,e=a.success,f=a.error;a.success=function(){e&&e.apply(this,arguments);d.resolve.apply(d,arguments)};a.error=function(){f&&f.apply(this,
arguments);d.reject.apply(d,arguments)};b.isOffline()?d.reject(c):h.ajax(a);d.error(j);return d};b.registerOfflineAjaxHandler=function(a){f.push(a)}})(Lavaca.resolve("Lavaca.net.Connectivity",!0),Lavaca.$);
(function(b,h,j){function g(b,c,d,e,f,g){b.position=c;e={id:d,state:e,title:f,url:g};b.sequence[c]=e;location.hash=a=g+"#@"+d;return e}var f=!(navigator.userAgent.indexOf("Android")>-1)&&typeof j.pushState=="function",c=false,a,d,e=0;b.History=h.extend(function(){h.call(this);this.sequence=[];this.position=-1;this.replace({},document.title,location.pathname);var b=this;if(f){this.onPopState=function(a){if(a.state){e--;b.trigger("popstate",{state:a.state.state,title:a.state.title,url:a.state.url})}};
window.addEventListener("popstate",this.onPopState,false)}else{this.onPopState=function(){var c=location.hash,d,f,g=-1;c&&(c=c.replace(/^#/,""));if(c!=a)if(a=c){e--;for(c=c.split("#@")[1];f=b.sequence[++g];)if(f.id==c){d=f;this.position=g;break}if(d){location.hash=d.url+"#@"+d.id;document.title=d.title;b.trigger("popstate",{state:d.state,title:d.title,url:d.url})}}};window.attachEvent?window.attachEvent("onhashchange",this.onPopState):window.addEventListener("hashchange",this.onPopState,false)}},
{current:function(){return this.sequence[this.position]||null},hasHistory:function(){return e>0},push:function(a,b,d){e++;if(c){document.title=b;f?j.pushState({state:a,title:b,url:d},b,d):g(this,++this.position,Lavaca.uuid(),a,b,d)}else this.replace(a,b,d)},replace:function(a,b,d){c=true;document.title=b;if(f)j.replaceState({state:a,title:b,url:d},b,d);else{if(this.position<0)this.position=0;var e=this.current()||{id:Lavaca.uuid()};g(this,this.position,e.id,a,b,d)}},dispose:function(){this.onPopState&&
(f?window.removeEventListener("popstate",this.onPopState,false):window.detachEvent?window.detachEvent("onhashchange",this.onPopState):window.removeEventListener("hashchange",this.onPopState,false));h.prototype.dispose.call(this)}});b.History.init=function(a){if(!d){a&&b.History.overrideStandardsMode();d=new b.History}return d};b.History.push=function(){b.History.init().push.apply(d,arguments)};b.History.replace=function(){b.History.init().replace.apply(d,arguments)};b.History.back=function(){j.back()};
b.History.forward=function(){j.forward()};b.History.dispose=function(){if(_history){d.dispose();d=null}};b.History.on=function(){return b.History.init().on.apply(d,arguments)};b.History.off=function(){return b.History.init().off.apply(d,arguments)};b.History.overrideStandardsMode=function(){f=false}})(Lavaca.resolve("Lavaca.net",!0),Lavaca.events.EventDispatcher,window.history);
(function(b,h,j){var g=new Lavaca.util.Cache,f=[];b.Template=j.extend({compile:function(){},render:function(){throw"Abstract";},process:function(b){this.code=b}});b.Template.get=function(b){return g.get(b)};b.Template.init=function(b){for(var a=-1,d;d=f[++a];)j.init(g,d.mime,function(a,b,c){return new d.js(a,b,c)},b)};b.Template.dispose=function(){j.dispose(g)};b.Template.render=function(c,a){var d=b.Template.get(c);if(d)return d.render(a);throw'No template named "'+c+'"';};b.Template.register=function(b,
a){f[f.length]={mime:b,js:a}}})(Lavaca.resolve("Lavaca.ui",!0),Lavaca.$,Lavaca.util.Map);
(function(b,h,j,g){b.DustTemplate=j.extend(function(b,c,a){j.apply(this,arguments);var d=this.prepareHelpers(),e;if(!h.helpers)h.helpers=[];for(e in d)h.helpers[e]=d[e]},{prepareHelpers:function(){return{msg:this.helperMsg,include:this.helperInclude,config:this.helperConfig}},helperMsg:function(b,c,a,d){var e=h.helpers.tap(d.key,b,c),j=h.helpers.tap(d.locale,b,c),k=g.get(e,j),e=[k],j=-1;if(!k)return a.block?b.render(a.block,c):b;for(a=d["p"+ ++j];typeof a!=="undefined";){e.push(h.helpers.tap(a,b,
c));a=d["p"+ ++j]}return b.write(Lavaca.util.StringUtils.format.apply(this,e))},helperInclude:function(b,c,a,d){var a=h.helpers.tap(d.name,b,c),e;j.render(a,c.stack.head).then(function(a){e=a});return b.write(e)},helperConfig:function(b,c,a,d){var e=h.helpers.tap(d.key,b,c),g=h.helpers.tap(d.environment,b,c),j=g?Lavaca.util.Config.get(g,e):Lavaca.util.Config.get(e),e=[j],g=-1;if(d.only||d.not){e=Lavaca.util.Config.currentEnvironment();return d.only&&e==d.only||d.not&&e!=d.not?a.block?b.render(a.block,
c):b:a["else"]?b.render(a["else"],c):b}if(!j)return a.block?b.render(a.block,c):b;for(a=d["p"+ ++g];typeof a!=="undefined";){e.push(h.helpers.tap(a,b,c));a=d["p"+ ++g]}return b.write(Lavaca.util.StringUtils.format.apply(this,e))},compile:function(){j.prototype.compile.call(this);h.loadSource(h.compile(this.code,this.name))},render:function(b){var c=new Lavaca.util.Promise(this);!this.code&&this.src&&this.load(this.src);if(this.code&&!this.compiled){this.compile();this.compiled=true}h.render(this.name,
b,function(a,b){a?c.reject(a):c.resolve(b)});return c},dispose:function(){delete h.cache[this.name];j.prototype.dispose.call(this)}});b.Template.register("text/dust-template",b.DustTemplate)})(Lavaca.ui,dust,Lavaca.ui.Template,Lavaca.util.Translation);(function(b,h,j){b.Widget=j.extend(function(b){j.call(this);this.el=b=h(b);var f=b.attr("id");if(!f){f="widget-"+Lavaca.uuid();b.attr("id",f)}this.id=f})})(Lavaca.resolve("Lavaca.ui",!0),Lavaca.$,Lavaca.events.EventDispatcher);
(function(b,h,j,g){function f(a){return a?null:"error_required"}function c(a,b){return a&&!RegExp(b.attr("pattern")).test(a)?"error_pattern":null}function a(a){return a&&!/^\w+@\w+(\.\w+)*\.\w+$/.test(a)?"error_email":null}function d(a){return a&&!/^\d?(\d{3})?\d{7}$/.test(a.replace(/\D/g,""))?"error_email":null}function e(a){return a&&!/^\d+(\.\d+)?$/.test(a)?"error_number":null}function l(a){return a&&!/^https?:\/\/\w+(\.\w+)*\.\w(:\d+)?\/\S+$/.test(a)?"error_url":null}b.Form=j.extend(function(){j.apply(this,
arguments);var a=this;this.pendingSync={};this._onChangeInput=function(b){a.onChangeInput(b)};this._onSubmit=function(b){a.onSubmit(b)};this.el.on("submit",this._onSubmit);this.addRule(this.defaultRules())},{onSubmit:function(a){a.preventDefault();this.validate().success(this.onSubmitSuccess).error(this.onSubmitError)},onSubmitSuccess:function(){},onSubmitError:function(){},onChangeInput:function(a){if(this.model){var b=h(a.target),a=b.attr("name"),b=b.val();this.pendingSync[a]=true;this.model.set(a,
b);this.pendingSync[a]=false}},onChangeModel:function(a){this.pendingSync[a.attribute]||this.set(a.attribute,a.value)},bind:function(a){this.unbind();this.model=a;a.on("change",this.onChangeModel,this);this.el.on("change",this._onChangeInput)},unbind:function(){if(this.model){this.el.off("change",this._onChangeInput);this.model.off("change",this.onchangeModel,this);this.model=null}},input:function(a){return this.el.find("input, select, textarea").filter('[name="'+a+'"]')},get:function(a){return this.input(a).val()},
set:function(a,b){this.input(a).val(b||null)},defaultRules:function(){return{"[required]":f,"[pattern]":c,"[type=email]":a,"[type=tel]":d,"[type=number]":e,"[type=url]":l}},addRule:function(a,b){if(!this.rules)this.rules=[];if(typeof a=="object")for(var c in a)this.addRule(c,a[c]);else this.rules.push({selector:a,callback:b})},values:function(){for(var a=this.el.find("input, select, textarea"),b={},c=-1,d,e,f;d=a[++c];){d=h(d);e=d.attr("type");if(!(e=="radio"||e=="checkbox")||d[0].checked){e=d.attr("name");
f=b[e];d=d.val();f instanceof Array?f.push(d):b[e]=f!==void 0?[f,d]:d}}return b},validate:function(a,b,c){if(a&&typeof a!="function"){c=a;a=null}c&&(c=h(c));for(var d=null,e=new g(this),f=-1,j,l,w,v,t,A,u,L,J;l=this.rules[++f];){w=c?c.filter(l.selector):this.el.find(l.selector);for(j=-1;v=w[++j];){v=h(v);J=v.val();if(t=l.callback.call(this,J,v,this)){A=v.attr("name");d||(d={});if(!d[A]){L=v.attr("id");u=null;L&&(u=this.el.find('label[for="'+L+'"]').text());d[A]={id:L,name:A,label:u,el:v,value:J,messages:[]}}d[A].messages.push(t)}}}d?
e.reject(d):e.resolve(this.values());return e.error(function(a){this.trigger("invalid",{inputs:a})}).success(function(a){this.trigger("valid",a)}).success(a).error(b)},dispose:function(){this.unbind();j.prototype.dispose.call(this)}});b.Form.withSubmit=function(a,c){return b.Form.extend({onSubmitSuccess:function(b){a.call(this,b)},onSubmitError:function(a){c.call(this,a)}})}})(Lavaca.ui,Lavaca.$,Lavaca.ui.Widget,Lavaca.util.Promise);
(function(b,h,j){b.LoadingIndicator=j.extend({className:"loading",show:function(){this.el.addClass(this.className)},hide:function(){this.el.removeClass(this.className)}});b.LoadingIndicator.init=function(g){function f(){c.hide()}var g=g||b.LoadingIndicator,c=new g(document.body);h(document).on("ajaxStart",function(){c.show()}).on("ajaxStop",f).on("ajaxError",f);return c}})(Lavaca.ui,Lavaca.$,Lavaca.ui.Widget);
