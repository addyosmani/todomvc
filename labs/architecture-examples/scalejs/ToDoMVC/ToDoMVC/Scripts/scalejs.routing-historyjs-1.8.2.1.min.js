define("scalejs.routing-historyjs/history",["scalejs!core","history","scalejs.reactive"],function(e,t){function n(e){return t.pushState(e.data,e.title,e.url)}function r(){return t.getState()}function o(e){return t.replaceState(e.data,e.title,e.url)}function i(){var n=e.reactive.Observable,o=e.reactive.Disposable;return n.createWithDisposable(function(e){var n=t.Adapter.bind(window,"statechange",function(){e.onNext(r())});return o.create(function(){t.Adapter.unbind(n)})}).publishValue(r()).refCount()}return{add:n,get:r,replace:o,observe:i}}),define("scalejs.routing-historyjs/routing",["scalejs!core","./history","scalejs.statechart-scion","scalejs.reactive"],function(e,t){function n(e){var t=e.split("&"),n={};return t.forEach(function(e){e=e.split("="),n[e[0]]=decodeURIComponent(e[1])}),n}function r(e,t){function n(e,t){var r=Object.keys(e);l(t)||(t=""),r.forEach(function(r){d(e[r],"object")?n(e[r],r):d(e[r],"array")?o.push(t+encodeURIComponent(r)+"="+encodeURIComponent(e[r].join(","))):o.push(t+encodeURIComponent(r)+"="+encodeURIComponent(e[r]))})}var r="",o=[];return l(e)&&(r="?"+e),l(t)&&(r+="?",n(t),r+=o.join("&")),r}function o(e){var t,r=e.hash.replace(/x-wmapp0:www\/x-wmapp0:www\/x-wmapp0:www\/index\.html/i,"").replace(/index\.release\.html/i,"").replace("/","");return 0===r.indexOf(".")&&(r=r.substr(1,r.length-1)),0!==r.indexOf("?")&&-1!==r.indexOf("?")&&(r=r.substr(r.indexOf("?"),r.length-1)),e=r.replace("?",""),""===e?{url:r,timestamp:(new Date).getTime()}:(e=e.split("?"),-1!==e[0].indexOf("&")?{query:n(e[0]),url:r,timestamp:(new Date).getTime()}:(t=decodeURIComponent(e[0]),l(e[1])?{location:t,query:n(e[1]),url:r,timestamp:(new Date).getTime()}:{location:t,url:r,timestamp:(new Date).getTime()}))}function i(e,n){C?(C=!1,t.replace({url:r(e,n)})):t.add({url:r(e,n)})}function a(e,t){return t=t||function(){return void 0},v(function(n){j[n.id]={location:e,query:t};var r=f("routed",function(t){return t.data.location===e},b(n.id));c?w("router",r):x.push(r)})}function s(){return t.observe().select(o)}function u(t){function n(){function e(e){return e===t}var t;u.add(y().subscribe(function(e){var n,o;l(j,e.state)&&"entry"===e.event&&(n=j[e.state],o=n.query.call(e.context),t=r(n.location,o),t="?/"===t?"?":t,i("/"===n.location?"":n.location,o))})),u.add(s().subscribe(function(t){if(!e(t.url)){var n=t.query||{},r=t.location||"/";l(o)&&(r=r.replace(new RegExp(o,"i"),"")),h("routed",{location:r||"/",query:n},0)}}))}if(c)return c;var o,a,u=new e.reactive.CompositeDisposable;return l(t,"baseUrl")?(o=t.baseUrl,a=p(arguments).slice(1,arguments.length)):a=p(arguments),c=g.apply(null,["router",m(n),f("router.disposing",b("router.disposed")),g("router.waiting"),g("router.disposed",m(function(){u.dispose(),j={},x=[]}))].concat(x).concat(a))}var c,l=e.object.has,d=e.type.is,p=e.array.toArray,f=e.state.builder.on,b=e.state.builder.gotoInternally,m=e.state.builder.onEntry,g=e.state.builder.state,h=e.state.raise,v=e.functional.builder.$yield,y=e.state.observe,w=e.state.registerTransition,j={},x=[],C=!0;return{route:a,routerState:u}}),define("scalejs.routing-historyjs",["scalejs!core","./scalejs.routing-historyjs/routing"],function(e,t){e.registerExtension({routing:t})});